<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.2" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.2" />






<meta name="description" content="�������ɣ�������̫��">
<meta property="og:type" content="website">
<meta property="og:title" content="Fatart&#39;s blog">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="Fatart&#39;s blog">
<meta property="og:description" content="�������ɣ�������̫��">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Fatart&#39;s blog">
<meta name="twitter:description" content="�������ɣ�������̫��">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/"/>





  <title>Fatart's blog</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Fatart's blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/C++ const关键字/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Fatart's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/C++ const关键字/" itemprop="url">C++ 引用的概念和应用</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-08-29T14:46:25+08:00">
                2017-08-29
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/C/" itemprop="url" rel="index">
                    <span itemprop="name">C++</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><a href="https://courses.edx.org/asset-v1:PekingX+04831750.1x+2015T1+type@asset+block@005const.pdf" target="_blank" rel="external">PPT</a><br>此外还可以参考C++ primer P53 const限定符一节</p>
<h1 id="定义常量"><a href="#定义常量" class="headerlink" title="定义常量"></a>定义常量</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">const int MAX_VAL = 23；</div><div class="line">const string SCHOOL_NAME = “Peking University”</div></pre></td></tr></table></figure>
<h2 id="定义指向常量的指针（pointer-to-const）"><a href="#定义指向常量的指针（pointer-to-const）" class="headerlink" title="定义指向常量的指针（pointer to const）"></a>定义指向常量的指针（pointer to const）</h2><h3 id="不可通过指向常量的指针修改其指向的内容"><a href="#不可通过指向常量的指针修改其指向的内容" class="headerlink" title="不可通过指向常量的指针修改其指向的内容"></a>不可通过指向常量的指针修改其指向的内容</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">int n,m;</div><div class="line">const int * p = &amp; n;    //*在指针上，p是一个指向常量的指针</div><div class="line">* p = 5;                //编译出错，不能通过p改变指向对象的值</div><div class="line">n = 4; //ok</div><div class="line">p = &amp;m; //ok,           指向常量指针的指向可以变化</div></pre></td></tr></table></figure>
<h3 id="不能把指向常量的指针（pointer-to-const）赋值给非指向常量指针，反过来可以"><a href="#不能把指向常量的指针（pointer-to-const）赋值给非指向常量指针，反过来可以" class="headerlink" title="不能把指向常量的指针（pointer to const）赋值给非指向常量指针，反过来可以"></a>不能把指向常量的指针（pointer to const）赋值给非指向常量指针，反过来可以</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">const int * p1; int * p2; //pi是一个指向常量的指针，p2是一个普通指针</div><div class="line">p1 = p2; //ok</div><div class="line">p2 = p1; //error</div><div class="line">p2 = (int * ) p1; //ok,强制类型转换</div></pre></td></tr></table></figure>
<h3 id="常量指针（const-pointer）和指向常量的指针还是要区分开来的！"><a href="#常量指针（const-pointer）和指向常量的指针还是要区分开来的！" class="headerlink" title="常量指针（const pointer）和指向常量的指针还是要区分开来的！"></a>常量指针（const pointer）和指向常量的指针还是要区分开来的！</h3><ul>
<li>指向常量的指针(pointer to const):不能用于改变其所指向对象的值</li>
<li>常量指针（const pointer）：(*放在const)前，说明指针本身是个常量，不能改变指向关系</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">int errNumb = 0;</div><div class="line">int *const curErr = &amp; errNumb;   //curErr是个常量指针，其只能指向errNumb地址，地址处存一个int对象</div><div class="line">const double pi = 3.14;</div><div class="line">const double *pi2 = &amp;pi;         //pi2是一个指向常量的指针，pi2不能够改变指向的对象的值</div><div class="line">const double *const pip = &amp; pi;  //pip是一个常量指针，只能指向pi地址，地址处存一个const double对象</div></pre></td></tr></table></figure>
<h2 id="对常量的应用-reference-to-const-常被称为常量引用"><a href="#对常量的应用-reference-to-const-常被称为常量引用" class="headerlink" title="对常量的应用(reference to const),常被称为常量引用"></a>对常量的应用(reference to const),常被称为常量引用</h2><p>不能通过常引用修改其引用的变量</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">int n;</div><div class="line">const int &amp; r = n;</div><div class="line">r = 5; //error</div><div class="line">n = 4; //ok</div></pre></td></tr></table></figure>
<h2 id="当使用了typedef时通常会造成误解-refer-to-Cpp-Primer-Page61"><a href="#当使用了typedef时通常会造成误解-refer-to-Cpp-Primer-Page61" class="headerlink" title="当使用了typedef时通常会造成误解(refer to Cpp Primer Page61)"></a>当使用了typedef时通常会造成误解(refer to Cpp Primer Page61)</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">typedef char *pstring;</div><div class="line">const pstring cstr = 0; //cstr是指向char的常量指针</div><div class="line">const pstring *ps;      //ps是一个指针，他的对象是指向char的常量指针</div></pre></td></tr></table></figure>
<p>如果简单地将pstring替换成char<em>来理解，则为<br>const char</em> str = 0;  //str是一个指向常量（char型）的指针<br>实际上应该是这样的  char *const str = 0；str是常量指针</p>
<p>这种理解是错误的</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/C++ 引用的概念和应用/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Fatart's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/C++ 引用的概念和应用/" itemprop="url">C++ 引用的概念和应用</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-08-29T14:01:25+08:00">
                2017-08-29
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/C/" itemprop="url" rel="index">
                    <span itemprop="name">C++</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><a href="https://courses.edx.org/asset-v1:PekingX+04831750.1x+2015T1+type@asset+block@004%E5%BC%95%E7%94%A8.pdf" target="_blank" rel="external">PPT</a></p>
<h1 id="基本概念"><a href="#基本概念" class="headerlink" title="基本概念"></a>基本概念</h1><p>下面的写法定义了一个引用，并将其初始化为引用某个变量。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">类型名 &amp; 引用名 = 某变量名;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">int n = 4;</div><div class="line">int &amp; r = n; // r引用了 n, r的类型是 int &amp;</div></pre></td></tr></table></figure>
<ul>
<li>定义引用时一定要将其初始化成引用某个变量。</li>
<li>初始化后，它就一直引用该变量，不会再引用别的变量了。</li>
<li>引用只能引用<strong>变量</strong>，<strong>不能</strong>引用常量和表达式。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">#include &lt;iostream&gt;</div><div class="line">using namespace std;</div><div class="line"></div><div class="line">int main()</div><div class="line">&#123;</div><div class="line">	double a = 4, b = 5;</div><div class="line">	double &amp;r1 = a;  //r1的类型为 double &amp;</div><div class="line">	double &amp;r2 = r1; //r2的类型为 double &amp;</div><div class="line">	r2 = 10;</div><div class="line">	cout &lt;&lt; a &lt;&lt; endl; //输出 10</div><div class="line">	r1 = b;           </div><div class="line">	cout &lt;&lt; a &lt;&lt; endl; //输出 5</div><div class="line"></div><div class="line">	return 0;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="引用应用的简单示例"><a href="#引用应用的简单示例" class="headerlink" title="引用应用的简单示例"></a>引用应用的简单示例</h2><p>C语言中，如何编写交换两个整型变量值的函数?</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">void swap( int * a, int * b)</div><div class="line">&#123;</div><div class="line">    int tmp;</div><div class="line">    tmp = * a; * a = * b; * b = tmp;</div><div class="line">&#125;</div><div class="line">int n1, n2;</div><div class="line">swap(&amp; n1,&amp; n2) ; // n1,n2的值被交换</div></pre></td></tr></table></figure>
<p>有了C++的引用：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">void swap( int&amp; a, int&amp; b)</div><div class="line">&#123;</div><div class="line">    int tmp;</div><div class="line">    tmp = a; a = b; b = tmp;</div><div class="line">&#125;</div><div class="line">int n1, n2;</div><div class="line">swap(n1,n2) ; // n1,n2的值被交换</div></pre></td></tr></table></figure></p>
<h2 id="引用作为函数的返回值"><a href="#引用作为函数的返回值" class="headerlink" title="引用作为函数的返回值"></a>引用作为函数的返回值</h2><p>这一节参考C++ primer 6.3节函数-引用返回左值<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">int n = 4;</div><div class="line">int &amp; SetValue() &#123; return n; &#125;</div><div class="line">int main()</div><div class="line">&#123;</div><div class="line">    SetValue() = 40;</div><div class="line">    cout &lt;&lt; n;</div><div class="line">    return 0;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>SetValue()返回类型为int&amp;，对SetValue()赋值就是对n进行赋值，相当于 n = 40;</p>
<h2 id="常引用"><a href="#常引用" class="headerlink" title="常引用"></a>常引用</h2><p>定义引用时，前面加const关键字，即为“常引用”</p>
<p>不能通过常引用去修改其引用的内容:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">int n;</div><div class="line">const int &amp; r = n; //r 的类型是 const int &amp;</div></pre></td></tr></table></figure>
<h3 id="常引用和非常引用的转换"><a href="#常引用和非常引用的转换" class="headerlink" title="常引用和非常引用的转换"></a>常引用和非常引用的转换</h3><p>const T &amp; 和T &amp; 是不同的类型!!!</p>
<ul>
<li>T &amp; 类型的引用或T类型的变量可以用来初始化const T &amp; 类型的引用。</li>
<li>const T 类型的常变量和const T &amp;类型的引用则不能用来初始化T&amp;类型的引用，除非进行强制类型转换。</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/C++ 位运算/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Fatart's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/C++ 位运算/" itemprop="url">C++ 位运算</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-08-29T13:31:25+08:00">
                2017-08-29
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/C/" itemprop="url" rel="index">
                    <span itemprop="name">C++</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><a href="https://courses.edx.org/asset-v1:PekingX+04831750.1x+2015T1+type@asset+block@003%E4%BD%8D%E8%BF%90%E7%AE%97.pdf" target="_blank" rel="external">PPT</a></p>
<h1 id="基本概念"><a href="#基本概念" class="headerlink" title="基本概念"></a>基本概念</h1><p><strong>位运算：</strong><br>用于对整数类型（int,char, long 等）变量中的某一位(bit)，或者若干位进行操作。比如:</p>
<p>1) 判断某一位是否为<br>2) 只改变其中某一位，而保持其他位都不变。</p>
<p>C/C++语言提供了六种位运算符来进行位运算操作</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&amp;      按位与(双目)</div><div class="line">|      按位或(双目)</div><div class="line">^      按位异或(双目)</div><div class="line">~      按位飞（单目）</div><div class="line">&lt;&lt;     左移(双目)</div><div class="line">&gt;&gt;     右移(双目)</div></pre></td></tr></table></figure>
<h3 id="按位与-“-amp-”"><a href="#按位与-“-amp-”" class="headerlink" title="按位与 “&amp;”"></a>按位与 “&amp;”</h3><p>将参与运算的两操作数各对应的二进制位进行与操作，只有对应的两个二进位均为1时，结果的对应二进制位才为1，否则为0。</p>
<p>例如：表达式“21 &amp; 18 ”的计算结果是16(即二进制数10000)，因为：</p>
<p>21 用二进制表示就是：</p>
<p>0000 0000 0000 0000 0000 0000 0001 0101</p>
<p>18 用二进制表示就是:</p>
<p>0000 0000 0000 0000 0000 0000 0001 0010</p>
<p>二者按位与所得结果是：</p>
<p>0000 0000 0000 0000 0000 0000 0001 0000</p>
<p>通常用来将某变量中的某些位<strong>清0</strong>且同时保留其他位不变。也可以用来获取某变量中的某一位。<br>例如，如果需要将int型变量n的低8位全置成0，而其余位<br>不变，则可以执行：</p>
<p>n = n &amp; 0xffffff00;</p>
<p>也可以写成：</p>
<p>n &amp;= 0xffffff00;</p>
<p>如果n是short类型的，则只需执行：</p>
<p>n &amp;= 0xff00;</p>
<p>如何判断一个int型变量n的第7位（从右往左，从0开始数）是否是1 ?</p>
<p>只需看表达式 “n &amp; 0x80”的值是否等于0x80即可。</p>
<p>0x80: 1000 0000</p>
<h3 id="按位或-“-”"><a href="#按位或-“-”" class="headerlink" title="按位或 “|”"></a>按位或 “|”</h3><p>将参与运算的两操作数各对应的二进制位进行或操作，只有对应的两个二进位都为0时，结果的对应二进制位才是0，否则为1。</p>
<p>按位或运算通常用来将某变量中的某些位<strong>置1</strong>且保留其他位不变。</p>
<p>例如，如果需要将int型变量n的低8位全置成1，而其余位不变，则可以执行：</p>
<p>n |= 0xff;</p>
<p>0xff: 1111 1111</p>
<h3 id="按位异或-“-”"><a href="#按位异或-“-”" class="headerlink" title="按位异或 “^”"></a>按位异或 “^”</h3><p>将参与运算的两操作数各对应的二进制位进行异或操作，即只有对应的两个二进位不相同时，结果的对应二进制位才是1，否则为0。</p>
<p>按位异或运算通常用来将某变量中的某些位<strong>取反</strong>，且保留其他位不变。</p>
<p>例如，如果需要将int型变量n的低8位取反，而其余位不变，则可以执行：</p>
<p>n ^= 0xff;</p>
<p>0xff: 1111 1111</p>
<h3 id="按位非-“-”"><a href="#按位非-“-”" class="headerlink" title="按位非 “~”"></a>按位非 “~”</h3><p>按位非运算符“~”是单目运算符。其功能是将操作数中的二进制位0变成1，1变成0</p>
<h3 id="左移运算符-“-lt-lt-”"><a href="#左移运算符-“-lt-lt-”" class="headerlink" title="左移运算符 “&lt;&lt;”"></a>左移运算符 “&lt;&lt;”</h3><p>实际上，左移1位，就等于是乘以2，左移n位，就等于是乘以2n。而左移操作比乘法操作快得多。</p>
<h3 id="右移运算符-“-gt-gt-”"><a href="#右移运算符-“-gt-gt-”" class="headerlink" title="右移运算符 “&gt;&gt;”"></a>右移运算符 “&gt;&gt;”</h3><p>实际上，右移n位，就相当于左操作数除以2n，并且将结果往小里取整。</p>
<h1 id="思考题"><a href="#思考题" class="headerlink" title="思考题"></a>思考题</h1><ol>
<li><p>有两个int型的变量a和n(0 &lt;= n &lt;= 31)，要求写一个表达式，使该表达式的值和a的第n位相同。</p>
<p> a&amp;(1&lt;<n)>&gt;n 或 (a&gt;&gt;n)&amp;1</n)></p>
</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/C++ 命令行参数/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Fatart's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/C++ 命令行参数/" itemprop="url">C++ 命令行参数</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-08-29T13:22:25+08:00">
                2017-08-29
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/C/" itemprop="url" rel="index">
                    <span itemprop="name">C++</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="基本概念"><a href="#基本概念" class="headerlink" title="基本概念"></a>基本概念</h1><p>将用户在CMD窗口输入可执行文件名的方式启动程序时，跟在可执行文件名后面的那些字符串，称为“命令行参数”。命令行参数<br>可以有多个，以空格分隔。比如，在CMD窗口敲：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">copy file1.txt file2.txt</div></pre></td></tr></table></figure>
<p>“copy”, “file1.txt”, “file2.txt”  就是命令行参数</p>
<h3 id="如何在程序中获得命令行参数呢"><a href="#如何在程序中获得命令行参数呢" class="headerlink" title="如何在程序中获得命令行参数呢"></a>如何在程序中获得命令行参数呢</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">int main(int argc, char * argv[])</div><div class="line">&#123;</div><div class="line">……</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>argc: 代表启动程序时，命令行参数的个数。C/C++语言规定，可执行程序程序本身的文件名，也算一个命令行参数，因此，argc的值至少是1。</li>
<li>argv: 指针数组，其中的每个元素都是一个char*类型的指针，该指针指向一个字符串，这个字符串里就存放着命令行参数。例如，argv[0]指向的字符串就是第一个命令行参数，即可执行程序的文件名，argv[1]指向第二个命令行参数，argv[2]指向第三个命令行参数……。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">#include &lt;stdio.h&gt;</div><div class="line">  int main(int argc, char * argv[])</div><div class="line">&#123;</div><div class="line">    for(int i = 0;i &lt; argc; i ++ )</div><div class="line">    printf( &quot;%s\n&quot;,argv[i]);</div><div class="line">    return 0;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>将上面的程序编译成sample.exe，然后在控制台<br>窗口敲:<br>sample para1 para2 s.txt 5 “hello world” </p>
<p>输出结果就是：<br>sample</p>
<p>para1</p>
<p>para2</p>
<p>s.txt</p>
<p>5</p>
<p>hello world</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/C++ 函数指针/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Fatart's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/C++ 函数指针/" itemprop="url">C++ 函数指针</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-08-29T12:46:25+08:00">
                2017-08-29
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/C/" itemprop="url" rel="index">
                    <span itemprop="name">C++</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="基本概念"><a href="#基本概念" class="headerlink" title="基本概念"></a>基本概念</h1><p>程序运行期间，每个函数都会占用一段连续的内存空间。而函数名就是该函数所占内存区域的起始地址(也称“入口地址”)。我们可以将函数的入口地址赋给一个指针变量，使该指针变量指向该函数。然后通过指针变量就可以调用这个函数。这种指向函数的指针变量称为“函数指针”。</p>
<h2 id="定义形式"><a href="#定义形式" class="headerlink" title="定义形式"></a>定义形式</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">类型名 (* 指针变量名)(参数类型1, 参数类型2,…);</div></pre></td></tr></table></figure>
<p>例如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">int (*pf)(int ,char);</div></pre></td></tr></table></figure>
<p>表示pf是一个函数指针，它所指向的函数，返回值类型应是int，该函数应有两个参数，第一个是int 类型，第二个是char类型。</p>
<h2 id="使用方法"><a href="#使用方法" class="headerlink" title="使用方法"></a>使用方法</h2><p>可以用一个原型匹配的函数的名字给一个函数指针赋值。</p>
<p>要通过函数指针调用它所指向的函数，写法为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">函数指针名(实参表);</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">#include &lt;stdio.h&gt;</div><div class="line">void PrintMin(int a,int b) &#123;</div><div class="line"> if( a&lt;b )</div><div class="line">    printf(&quot;%d&quot;,a);</div><div class="line"> else</div><div class="line">    printf(&quot;%d&quot;,b);</div><div class="line">&#125;</div><div class="line">int main() &#123;</div><div class="line"> void (* pf)(int ,int);</div><div class="line"> int x = 4, y = 5;</div><div class="line"> pf = PrintMin;</div><div class="line"> pf(x,y); //输出结果4</div><div class="line"> return 0;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="函数指针应用"><a href="#函数指针应用" class="headerlink" title="函数指针应用"></a>函数指针应用</h2><table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>a[0]</td>
<td>a[1]</td>
<td>…</td>
<td>a[i]</td>
<td>…</td>
<td>a[n-1]</td>
</tr>
</tbody>
</table>
<p>C语言快速排序库函数：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">void qsort(void *base, int nelem, unsigned int width,</div><div class="line">int ( * pfCompare)( const void *, const void *));</div></pre></td></tr></table></figure>
<p>可以对任意类型的数组进行排序</p>
<p>对数组排序，需要知道：</p>
<ul>
<li>数组起始地址</li>
<li>数组元素的个数</li>
<li>每个元素的大小（由此可以算出每个元素的地址） </li>
<li>元素谁在前谁在后的规则</li>
</ul>
<p>在函数中</p>
<ul>
<li>base: 待排序数组的起始地址，</li>
<li>nelem: 待排序数组的元素个数，</li>
<li>width: 待排序数组的每个元素的大小（以字节为单位）</li>
<li>pfCompare :比较函数的地址</li>
</ul>
<p>pfCompare: 函数指针，它指向一个“比较函数”。<br>该比较函数应为以下形式：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">int 比较函数名(const void * elem1, const void * elem2);</div></pre></td></tr></table></figure>
<p>比较函数是程序员自己编写的</p>
<p>排序就是一个不断比较并交换位置的过程。<br>qsort函数在执行期间，会通过pfCompare指针调用 “比较函数”，调用时将要比较的两个元素的地址传给“比较函数”,然后根据“比较函数”返回值判断两个元素哪个更应该排在前面。</p>
<p>比较函数编写规则：<br>1) 如果 <em> elem1应该排在 </em> elem2前面，则函数返回值是负整数<br>2) 如果 <em> elem1和</em> elem2哪个排在前面都行，那么函数返回0<br>3) 如果 <em> elem1应该排在 </em> elem2后面，则函数返回值是正整数</p>
<h2 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h2><p>下面的程序，功能是调用qsort库函数，将一个unsigned int数组按照个位数从小到大进行排序。比如 8，23，15三个数，按个位数从小到大排序，就应该是 23，15，8</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">#include &lt;stdio.h&gt;</div><div class="line">#include &lt;stdlib.h&gt;</div><div class="line">int MyCompare( const void * elem1, const void * elem2 )</div><div class="line">&#123;</div><div class="line">    unsigned int * p1, * p2;</div><div class="line">    p1 = (unsigned int *) elem1; // “* elem1” 非法，*elem1无定义，需要转换成 unsigned int*</div><div class="line">    p2 = (unsigned int *) elem2; // “* elem2” 非法</div><div class="line">    return (* p1 % 10) - (* p2 % 10 );</div><div class="line">&#125;</div><div class="line">#define NUM 5</div><div class="line">int main()</div><div class="line">&#123;</div><div class="line">    unsigned int an[NUM] = &#123; 8,123,11,10,4 &#125;;</div><div class="line">    qsort( an,NUM,sizeof(unsigned int), MyCompare);</div><div class="line">    for( int i = 0;i &lt; NUM; i ++ )</div><div class="line">    printf(&quot;%d &quot;,an[i]); //输出结果：10 11 123 4 8</div><div class="line">    return 0;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="思考，如果从大到小排序给出程序？"><a href="#思考，如果从大到小排序给出程序？" class="headerlink" title="思考，如果从大到小排序给出程序？"></a>思考，如果从大到小排序给出程序？</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">#include &lt;stdio.h&gt;</div><div class="line">#include &lt;stdlib.h&gt;</div><div class="line">int MyCompare(const void * elem1, const void * elem2)</div><div class="line">&#123;</div><div class="line">	unsigned int * p1, *p2;</div><div class="line">	p1 = (unsigned int *)elem1; // “* elem1” 非法，*elem1无定义，需要转换成 unsigned int*</div><div class="line">	p2 = (unsigned int *)elem2; // “* elem2” 非法</div><div class="line">	return (*p2 % 10) - (*p1 % 10); //不同处</div><div class="line">&#125;</div><div class="line">#define NUM 5</div><div class="line">int main()</div><div class="line">&#123;</div><div class="line">	unsigned int an[NUM] = &#123; 8,123,11,10,4 &#125;;</div><div class="line">	qsort(an, NUM, sizeof(unsigned int), MyCompare);</div><div class="line">	for (int i = 0; i &lt; NUM; i++)</div><div class="line">		printf(&quot;%d &quot;, an[i]); //输出结果：10 11 123 4 8</div><div class="line">	return 0;</div><div class="line">&#125;</div></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/AI-Network survery/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Fatart's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/AI-Network survery/" itemprop="url">Emerging Heterogeneous Networks</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-08-25T10:46:25+08:00">
                2017-08-25
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/AI-Network/" itemprop="url" rel="index">
                    <span itemprop="name">AI-Network</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="ABSTRACT"><a href="#ABSTRACT" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h1><p>目前出现的移动异构网络(mobile heterogeneous network HetNets)在复杂的系统资源上存在:有效组织，管理，维护，优化相关的许多技术难题。<br>学术界和工业界研究使用AI(artificial intelligence)相关的技术（如机器学习machine learing，仿生算法bio-inspired algorithm，模糊神经网络fuzzy neural network…）</p>
<p>这篇文章主要讲的是HetNets网络架构和系统演进中相关的AI技术的前沿知识，重点是研究网络的自我配置(self-configuration),自我修复(self-healing),自我优化(self-optimization)。</p>
<p>通过讨论使用基于AI的技术来处理HetNets不同问题的利弊(pros and cons)时，将会给出HetNet AI 技术详细分类（taxonomy）。<br>开放性研究问题和待解决的挑战(pending challenge)也包含在内，它们能为未来研究工作提供指导(guideline)。</p>
<h1 id="Index-terms"><a href="#Index-terms" class="headerlink" title="Index terms"></a>Index terms</h1><p>Artificial intelligence      人工智能</p>
<p>genetic algorithm            遗传算法</p>
<p>ant colony algorithm         蚁群算法</p>
<p>self-organization networks   自组织网络</p>
<p>heterogeneous neworks        异构网络</p>
<h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>由于当代Internet和移动通信的迅速发展，近年来移动流量有着爆炸性的增长。因此（accordingly）,移动网络运行商(mobile network operators-MNOs)系统已经设计改造，其有着更加复杂(complexity)的架构和各种各样的相关设备和资源，以及更多动态的网络形式。它们正在向有前途(promising)的未来网络模式发展，异构网络(HetNets).</p>
<p>异构网络(Heterogeneous networks)有许多不同类型的小区(cell)，各个小区有着不同的传输能量，覆盖范围以及工作机制(mechanism)。如图1</p>
<p><img src="http://fatart.space/%E5%9B%BE%E7%89%87/network/1.png" alt="image"></p>
<ul>
<li><p>比如说宏小区macrocell，在WiMax（Worldwide Interoperability for Mocrowave access）中的基站base station(BS)，以及在LTE(long-term evolution)中的enhanced NodeBs(eNBs).这些宏小区有着最大的传输能量，能覆盖室外约几十千米。</p>
</li>
<li><p>picocell微微小区的覆盖范围相对较小，主要覆盖大楼室内环境。</p>
</li>
<li><p>femtocell毫微微小区有着小型体积、低功耗、低功率、用户设定的接入点ap，接入点一般位于办公室和家里。</p>
</li>
<li><p>中继relay是MNO(mobile network operator)移动运行商布置的AP，其只负责路由 macro cell 和 覆盖性能差的地区、不能覆盖到的地区的之间的路由。</p>
</li>
</ul>
<p>因此，由于网络架构的复杂，将导致有效组织，管理和优化网络资源的问题非常复杂。与此同时，飞速增长(skyrocket)的移动流量的需求产生了巨大的压力。尽管已经提出一些技术来直接改善HetNets性能，如何通过其他改进的技术和算法来自动地处理HetNet的复杂性是一个研究热点。</p>
<p><em>Brains exist because the distribution of resources necessary for survival and the hazards that threaten survival vary in space and time。</em></p>
<p>智能的存在是因为生存需要和威胁生存资源的分配在时间和空间上不停地变化，将AI引入HetNet是一样的，HetNet动态性、异构型、大规模、复杂性不停增加，所以很长一段时间，研究者不遗余力（spare no effort）地将AI技术引入，以实现HetNet的自动管理和优化。</p>
<p>AI技术包括机器学习machine learning，仿生算法bio-inspired algorithm，模糊神经网络fuzzy neural network等多学科技术。它们已经被研究并运用到优化各种不同的场和复杂环境下的计算机系统和网络。</p>
<p>已经证明，AI技术能够获得杰出的性能，因为他们的大部分都是从自然发现启发或者人类思维方式推动的。它们通常是相对地复杂性的，通过循环基于(recursive)反馈学习和局部交互，因此，和一般的技术相比，求解sub-optimal结论的速度更快。因此，结合AI技术以设计智能网络架构是一个非常有前途趋势，能够有效解决HetNet的问题，诸如cell planning，fault-trolerance,reource management以及优化。</p>
<p>从降低MNO移动运营商的操作和资金开支（opex and capex），基于AI的技术能够大大(substantially)降低操作性任务中人工参与并能优化网络容量、覆盖和服务质量Qos。</p>
<p>根据在自组网（self-orgnizing network）中讨论的先进特征：</p>
<ol>
<li><p>self configuration </p>
<p> 新部署的各种小区在进行操作任务前都是自动配置、更新。</p>
</li>
<li><p>self healing</p>
<p> 小区和网络能自动检测并从错位中恢复，甚至当错误发生时，执行补偿机制（compensation machanism）</p>
</li>
<li><p>self optimization</p>
<p> 蜂窝系统能够测量网络状态并优化设定以增强如覆盖面积、带宽、冲突避免以及QoS，与此同时相关的如系统可拓展性、能量转化也会考虑在内。</p>
</li>
</ol>
<p>这篇文章调查了基于AI的前沿技术，该技术用于增强HetNet架构和系统的智能。讨论了研究者如何将机器学习machine learning，遗传算法genetic algorithm，蚁群优化的人工神经网络ant colony optimization artifical neural networks，模糊系统fuzzy system，马尔科夫模型Markov ，贝叶斯模型Bayesian Models，这些技术用来增加智能度、效率、性能和网络服务质量QoS。</p>
<p>文章架构如下：</p>
<ul>
<li>为什么intelligence在发展HetNet是需要的(第二节)</li>
<li>HetNet能够从AI技术获益的一些相关问题(第三节)</li>
<li>总结了用于HetNet的AI技术(第四节)</li>
<li>新的挑战和机遇(第五节)</li>
<li>总结</li>
</ul>
<h1 id="HetNet的兴起"><a href="#HetNet的兴起" class="headerlink" title="HetNet的兴起"></a>HetNet的兴起</h1><p>新兴的移动网络变得更加动态、异构、大规模、系统复杂，因此新兴的HetNet在架构上包含了各种不同容量、限制和操作函数的无线接入技术。</p>
<p>在最新发布的LTE-A中设想了是一个多层架构，包括macro-cell，pico-cell，femto-cell，relay station， remote radio heads。</p>
<p>Macro-cell base station: 宏小区基站使用专用回传信道(dedicated backhaul),提供有保证的带宽。</p>
<p>Pico-cell，femto-cell：它们都是小型（small-size）、低价格（low cost）、低能耗（low power）、用户部署（user deployed）的建筑和房屋内的接入点，在本地卸载数据流量。</p>
<p>Relay：中继是MNO部署的接入点，只用于传送宏小区到处在覆盖性能差或无法覆盖到的终端用户的信号，反之亦然。</p>
<p>RRH：Remote radio head是紧凑型（compact-size），高功率、低质量的单元，安装在传统宏基站的外面，并且通常通过用于创建分布式基站的光纤电缆与其连接。</p>
<p>marco BS: 负责控制和基带信号处理，一些射频电路转移到了RRHS</p>
<p>部署如此多类型的小区cell旨为流量负载从覆盖、位置、环境特征以及用户动态性方面减荷，为了有效提高频谱利用率。</p>
<p>因此，HetNet能够大大减少MNO（mobile network operator）移动网络运营商的OPEX/CAPEX。然而，hetnet带来了巨大设计挑战和问题，结合AI和自组网的Hetnet是迈向未来移动网络的最有效方式。</p>
<h2 id="self-evolution-in-HetNets"><a href="#self-evolution-in-HetNets" class="headerlink" title="self-evolution in HetNets"></a>self-evolution in HetNets</h2><p>在最近几年，SONs(Self-organization Network)经历了研究上的爆炸性增长。<strong>自组织网络</strong>通过降低人工干预降低了OPEX(operation expenditure)。自组织网络的思想是结合网络规划、配置，优化。</p>
<p>AI技术或许能够为HetNet(异构网络)上实现SON（自组织网络）提供有效的解决方案。</p>
<p><strong>HetNet-SONSs最主要的特征包括：self-configuration，self-optimization以及self-healing。</strong></p>
<p>使得HetNet具有自我进化的特征。self-planning和self-organization有时会和self-configuration分开来讲，但在这篇文章中，我们认为它们都是实现核心自动化的初始阶段，我们将会从上述三个特征介绍在HetNets中自组织网络相关的AI技术，适用于HetNet的SONs在图2中描述。<br><img src="http://fatart.space/%E5%9B%BE%E7%89%87/network/2.png" alt="image"></p>
<p>已经有许多研究关注于SONs的三个特征。研究[8]提出了在异构网络中(HetNet)用于Radio Access Network(RAN)的SONs，有着集中式的覆盖和容量优化方法，还有基于混合邻居式的小区停电检测，中心化的小区停电补偿。</p>
<p>研究[3]调查了不同的群智能启发的机制以及它们的设计准则，并且在HetNet上的人工SONs系统上验证了不同的优化算法。我们将在以下部分中详细介绍最新的相关文献，以提高HetNets的自我“X”能力。</p>
<h2 id="A-self-Configuration"><a href="#A-self-Configuration" class="headerlink" title="A self-Configuration"></a>A self-Configuration</h2><p>在HetNet的设计阶段，基站base station的位置(或者其他类型的小区基站)，基站之间的连接，以及相关的不同网络设备以及相关参数（输出概率，天线仰角等等）应该在所有设备都实际安装之前被确定好。但是，由于在HetNet中如此多类型的小区共存(coexistence)以及用户和服务的高度动态性，越来越多的参数需要管理和优化。一个很好的规划(planning)能够最佳地规划小区覆盖以及能够防止严重的小区边缘传播损耗(propagation loss),因此自动地获取到优化的参数设定是非常重要的，这样在HetNet中人类劳动会被降低。</p>
<p>基于AI的技术（如 遗传算法Genetic Algorithm）能够使用导频功率调整(pilot power adjustment)轻松地进行<strong>小区规划和覆盖优化</strong>。以及在HetNet中，最开始的阶段(the most initialisation phase)是<strong>自动化的物理小区标识分配</strong>（physical cwll identifier assignment）以及<strong>无线资源配置</strong>（radio resource configuration）。在规划（planning）和部署（placement）阶段后的配置阶段（configuration phase）中，新部署的小区基站（以及相关硬件）应当在进入到操作状态前，能够进行自动配置、彻底（throughly）测试以及通过下载和运行fireware/software进行自动验证，这个叫做”plug-and-play”模式。</p>
<p>已经有一些研究关于于HetNet的自动配置，大多是都是研究从具体的HetNet场景中提取出合适参数的方法。比如。研究[11]解决（address）了在5GHetNet网络中智能低功率节点的部署问题，通过结合认知无线电（cognitive radio）和小区间冲突协调（inter-cell interference coordination）,提出在使用自适应SON时，将合适的扇区和无线资源分配结合起来。以及，中继的部署也需要复杂的建模和配置，就像在研究[12]中，为了最大化系统容量而不需要去进行长久（protracted）的系统仿真研究，以确定有限干扰下的中继信道管理的参数。</p>
<p>还有一些研究关注于HetNet中<strong>分布式的beamforing配置</strong>，以获得一些优化的覆盖和信号质量的突破。和传统的beaming技术需要知道发送端信道的先验知识相比，仿生鲁棒自适应随机搜索算法被提出用来确保分布式发送端数量和收敛时间的线性关系。</p>
<h2 id="Self-Healing"><a href="#Self-Healing" class="headerlink" title="Self-Healing"></a>Self-Healing</h2><p>对于商业HetNet来说，<strong>鲁棒性</strong>是最重要的问题之一，MNOs需要稳定地支持大量的不同设备以及不同的用户。HetNet中的SON功能提供了必要的自我修复能力，基于主动跟踪、被动探测，错误更好的监测，恰当的后续补救（remedial）行动，如重新启动，失败后回退到备份系统，不补救设备转换等等。SON(self-organizated network)也提供一些方法来自动升级网络设备的软件，以修复遗留的bug（legacy bug）和问题，和调整参数使其自适应地避免错误。self-healing为网络系统的维护节省了大量的人工介入，并且能尽可能地从网络错误中恢复。</p>
<p>因此，AI技术能够方便地应用于自我修复，来保证网络服务和资源的可获得性（availability）。作为一个用于<strong>小区停电补偿cell outage compensation</strong>的代表性工作，提议[15]提出了一种自主粒子群补偿算法（autonomic particle swarm compensation algorithm)，在LTE HetNet中产生一个中心化的小区断电补偿方案，以缓和（mitigate）小区断电带来的性能恶化（degradation）</p>
<p>自动重新配置(autonomous re-configuration)也被认为是HetNet的SON一个关键特性。通过观察用户和网络状况的改变，HetNet在不停止移动服务的前提下，以一个实时的方式需要进行必要的重新配置。这些已经在[16]中研究，其已经提出了一个自适应的基于策略（policy）的动态重配置框架，根据重配置的需求动态创建并更新策略。尽管使用了Reinforcement Learning mrthodology，事前设定的策略在基于两层策略的框架下动态更新。然而，并没有考虑到网络控制机制的适应性和新的策略规则的即时（on-the-fly）推导。</p>
<h2 id="Self-Optimization"><a href="#Self-Optimization" class="headerlink" title="Self-Optimization"></a>Self-Optimization</h2><p>考虑到无线特性、流量动态性和用户服务的需求，HetNet的性能可以从多个方面增强，如<strong>负载均衡（load balance）、功率适应（power adaptation）、邻居维护（neighbourhood maintenance）、移动性管理（moblity management）</strong>。然而，真正的（practically）实时的优化（real-time optimization）是非常困难的，因为将涉及到非常繁重的工作负载来进行综合测量、统计学习、优化问题求解以及基于参数的决策。</p>
<h3 id="a-Automatic-coverage-optimization-and-load-balancing"><a href="#a-Automatic-coverage-optimization-and-load-balancing" class="headerlink" title="a) Automatic coverage optimization and load balancing"></a>a) Automatic coverage optimization and load balancing</h3><ul>
<li>调整天线参数</li>
<li>调整handover parameter来从逻辑上改变小区大小 </li>
</ul>
<p>自动化的覆盖优化旨在：通过协调调整相关小区之间的天线倾斜角和导频功率，最大化系统容量并保证邻小区之间合理的重叠（overlap）。</p>
<p>研究[17]提出了通过使用基于协调增强学习算法(cooperative reinforcement learnging)的fuzzy neural network optimization来对天线倾角(tilt)和功率进行self-optimization。</p>
<h3 id="b-Mobility-optimization"><a href="#b-Mobility-optimization" class="headerlink" title="b) Mobility optimization"></a>b) Mobility optimization</h3><p>通过自动调整小区重新选择(re-selection)和切换(handover)的阈值(thresholds)，以相关减少不必要的handover并提供合适的handover时机。</p>
<p>移动性优化也和load balance优化相关，可以调整参数阈值，自动地使得拥挤小区的边缘用户向邻居不拥塞小区reselect或handover。</p>
<p>移动性优化高度依赖于有效的邻小区维护，用户能够重刷新并重新配置邻小区列表，以保持漫游所需的最少小区集。</p>
<h3 id="c-Link-quality-estimation"><a href="#c-Link-quality-estimation" class="headerlink" title="c) Link quality estimation"></a>c) Link quality estimation</h3><p>必须始终以高可靠性执行链路质量估计，以便于在HetNets中进行具有鲁棒性的安全传输。</p>
<p>不是采用简单的移动平均估计器的传统静态链路质量感知路由度量，可以利用基于神经网络范例的生物启发式估计器来提高链路质量估计的有效性[18]。</p>
<h3 id="d-Device-to-Device-communications"><a href="#d-Device-to-Device-communications" class="headerlink" title="d) Device-to-Device communications"></a>d) Device-to-Device communications</h3><p>通过有效的干扰管理，通过利用有组织的设备到设备链路，设备到设备通信为HetNets提供了更高的可扩展性和大容量。</p>
<p>所需的资源分配可以从基于AI的技术中受益匪浅。例如，[19]的研究提出了蚁群优化基础智能管理，D2D对可以有效，自主，共同选择合适的资源块，调整功率，保证所有用户的信号质量。</p>
<h3 id="e-Relay-based-multi-hop-transmission"><a href="#e-Relay-based-multi-hop-transmission" class="headerlink" title="e) Relay-based multi-hop transmission"></a>e) Relay-based multi-hop transmission</h3><p>leverage 利用中间中继节点</p>
<ul>
<li>有效拓展服务范围</li>
<li>增强HetNet的可持续性</li>
</ul>
<h3 id="f-Virtical-Handoff-VHO"><a href="#f-Virtical-Handoff-VHO" class="headerlink" title="f) Virtical Handoff (VHO)"></a>f) Virtical Handoff (VHO)</h3><p>VHO作用“用户分布在RANs不同链路层技术的小区时，实现无缝(seamless)切换。</p>
<h2 id="HetNet中AI相关SON技术分类"><a href="#HetNet中AI相关SON技术分类" class="headerlink" title="HetNet中AI相关SON技术分类"></a>HetNet中AI相关SON技术分类</h2><h3 id="A-Maching-learning"><a href="#A-Maching-learning" class="headerlink" title="A) Maching learning"></a>A) Maching learning</h3><p>机器学习（ML）是从AI领域的模式识别和计算学习理论的研究而演变而来的[26]。它有效地学习人脑的方式，探索算法的构建和研究，并进行数据驱动的预测或决策[6]。 在许多ML技术中，强化学习（RL）是由行为主义心理学启发的一种特殊的学习算法，涉及到软件代理应该如何在环境中采取措施，以最大限度地提高一些累积值的概念。</p>
<p>从图3的图示中，RL(reinforcement learninf)旨在找到在一定时间段内使所观察到的值（即，payoff）最大化的策略，并且它经常用于网络系统中的信道接入和发射功率分配。</p>
<p>Q-learning是RL的一种形式，它是一种无模型的RL技术，可以为任何给定（有限）马尔可夫决策过程找到动作选择策略的最优质量值（Q值）[29]。因此，它能够对大部分HetNet中的自我优化对象使用，例如，在载波聚合期间具有定位信息的基于Q学习的动态资源分配和[30]和[31]中HetNets的不协调部署。由于hetnet中设备的不同，hetnet中干扰管理策略也能从Q-learning中收益[33]。</p>
<p>模糊强化学习(Fuzzy-reinforcement learning)是通过对HetNets中的不确定环境进行模糊状态表示和模糊目标的整合来进一步研究RL技术。</p>
<h3 id="B-Genetic-algorithm"><a href="#B-Genetic-algorithm" class="headerlink" title="B) Genetic algorithm"></a>B) Genetic algorithm</h3><p>GA采用基因演化程序，包括两个主要任务，交叉crossover，有利于获得最优解，突变mutation，防止落入区域最优解。后代在交叉操作中继承了优良染色体的基因，通过竞争消除了不良染色体。</p>
<p>通过多年的研究证明，GA有效解决潜在解决方案范围太大的问题，无法在合理的时间内彻底搜索，并且在大多数情况下可以在更短的时间内适当地收敛到最佳（或次优）结果，与其他情况生物启发bio-inspired的方法相比。</p>
<p>因此，GA能够轻松解决多目标问题，GA经常被用来解决Hetnet中的cell palnning和节点placement 优化问题，在此问题中需要评估大量的参数。</p>
<p>比如，研究[47]提出了多目标GA来解决异构网络多目标通信节点（比如天线和信道）安置问题，旨在最大化通信覆盖范围以及全部的容量带宽并且最小化的配置消耗。通过<br>自适应地调节导频功率，GA能够被用来改进小区覆盖优化。</p>
<h3 id="C-群智能swarm-intelligence-and-ant-colony-蚁群"><a href="#C-群智能swarm-intelligence-and-ant-colony-蚁群" class="headerlink" title="C) 群智能swarm intelligence and ant colony 蚁群"></a>C) 群智能swarm intelligence and ant colony 蚁群</h3><p>Ant colony optimization ACO是一个流行的群体智能(swarm intelligence)算法。在一个蚁群中，大量的蚂蚁使用基于以前积累的现象来发现导向食物的最佳路径。因为网络系统和蚁群的相似性，数据包和蚁群，网络路由和蚁群路径。<br>Ant colony optimization在HetNet在广泛的研究，作为一种有效的方法来处理冲突管理、路由以及覆盖</p>
<p>为了缓解小区间以及跨层的干扰协调，为信道分配，研究[51]探究了使用ACO的动态子信道分配。</p>
<p>网络路由能够从群体智能中获得大量的增强，因为其固有的路径优化策略。HetNet中的大多数路由问题发生在多跳传输中，ACO算法能够解决多目标路由优化问题，使用网络性能测量诸如延时delay、距离hop distance、负载load、费用cost以及可信度reliability。</p>
<p>研究[55]使用蚁群算法，通过发现每一个小区的最佳导频发射功率最小化费用函数(cost function)，来解决HetNet中的密集小区覆盖优化问题。</p>
<h3 id="D-artificial-neural-network"><a href="#D-artificial-neural-network" class="headerlink" title="D) artificial neural network"></a>D) artificial neural network</h3><p>artificial neural  network ANN是一种统计学习模型，从人脑的生物神经网络启发得到。<br>ANN一般地表现为包含着内部互联的神经元系统，有着数字权重的数值，其能够调谐以使得ANN适应于输入并且功能胜任学习的工作。</p>
<h3 id="Fuzzy-system"><a href="#Fuzzy-system" class="headerlink" title="Fuzzy system"></a>Fuzzy system</h3><p>模糊系统是基于模糊逻辑的控制系统，其数学分析了在0和1之间连续值的逻辑变量的模拟输入值[59]。模糊逻辑能够通过从不精确、不确定，或者不可靠的信息来创建规则。因此，它能够规则的集合，从基于HetNet中大量具有不同物理信息和不同变化条件、特征的系统化资源，来快速帮助做出决策。</p>
<h3 id="Markov-models-and-bayesian-based-games"><a href="#Markov-models-and-bayesian-based-games" class="headerlink" title="Markov models and bayesian-based games"></a>Markov models and bayesian-based games</h3><p>虽然马尔科夫模型[65]和贝叶斯方法[66]不完全是AI技术，但仍然为具有一定自动优化能力的HetNets提供统计解决方案。随着马尔科夫模型状态之间的随机转换（transition）以及基于贝叶斯学习，HetNet中定位和移动问题，基于决策书的预测可以改进HetNet中的本地化和移动性问题。</p>
<p>Hidden Markov Model（HMM）通常用来建模信号强度以获得精确的定位。研究[68]提出了Hetnet中是内还看优选的室内移动路由模型，基于HMM来实现移动建模和学习。</p>
<h1 id="Future-challenge"><a href="#Future-challenge" class="headerlink" title="Future challenge"></a>Future challenge</h1><p>移动网络已经从传统的中心化架构向分布式、分层次的异构网络转变，有着自动化、协调的、智能的新特性。在不久的未来，小区（基站）装配有某种自动化的机制，根据业务动态、用户需求，以及物理环境干扰条件进行最佳重新定位。</p>
<h2 id="A-optimization-on-virtual-resource-in-the-data-center-for-cloud-based-hetnets"><a href="#A-optimization-on-virtual-resource-in-the-data-center-for-cloud-based-hetnets" class="headerlink" title="A optimization on virtual resource in the data center for cloud-based hetnets"></a>A optimization on virtual resource in the data center for cloud-based hetnets</h2><p>5G演进的一个重要方向就是基于云计算技术的弹性、动态资源分类的资源虚拟化。不仅RRHs会和基于云RAN的虚拟资源合作，在HetNet中同样如此，无线接入和处理的计算密集性任务的大量计算负载将会被卸荷到MNO数据中心的集中式的云中。</p>
<p>举例来说，提议[75]引入了云协作的异构蜂窝网络(cloud cooperated heterogeneous cellular network-C-HetNet)的概念,在架构中，覆盖在宏小区之上的femtocell和picocell和云无线接入网络连接来实现协作。在研究[76]发展了一个理论上的HetNet部署代价框架，来探究C-RAN是否是代价最有效的。</p>
<h2 id="B-Utilizaing-the-intelligence-of-software-defined-network-in-5G-HetNets"><a href="#B-Utilizaing-the-intelligence-of-software-defined-network-in-5G-HetNets" class="headerlink" title="B Utilizaing the intelligence of software defined network in 5G HetNets"></a>B Utilizaing the intelligence of software defined network in 5G HetNets</h2><p>SDN提供实时数据包报告以及业务流特征的re-activityh功能，并为网络带来的基本的智能。</p>
<p>此外，SDN的精细数据包分类器以及在网络硬件上的数据平面和控制平面分离能够提供集中式的控制能力以及给力的可编程性能，通过网络资源分配。</p>
<p>因此，基于SDN用于业务识别以及实时可编程的固有数据包分类器,设计合适的方法和算法来处理网络失败恢复（self-healing）来保证服务和资源的可访问是大有潜力的。比如，研究[79]旨在通过在SDN辅助的相关接入点之间进行用户独立的安全上下文信息共享，来简化HetNet全局管理的鉴权切换。</p>
<p>仿生算法，如ACO和GA，它们通常是用来进行路由优化，能够利用SDN的可编程性加速业务流优化。</p>
<h2 id="C-distribute-edge-intelligence-in-hetnet"><a href="#C-distribute-edge-intelligence-in-hetnet" class="headerlink" title="C distribute edge intelligence in hetnet"></a>C distribute edge intelligence in hetnet</h2><p>将当下的移动网络去中心化并不是简单地将虚拟计算负载置入云数据中心，而是优先考虑将服务移动到网络边缘。<br>这种趋势的意义在于两个方面：</p>
<ul>
<li>降低了用户延时，服务提供商也能够在异构网络中享受到更多的收入机会（revenue opportunity），比如，本地化的内容，本地化的无线资源管理，以及在网路边缘的增值数据处理</li>
<li>降低核心网络拥塞,由于媒体密集型应用的激增(proliferation),网络拥塞越来越成为一个危机。</li>
</ul>
<p>此外，在新兴的HetNet中一些重要的问题，如不同设备之间的协调和管理。</p>
<p>边缘智能的一个技术问题是Base sation caching，通过这种方法，内容传输的大部分内容能够由在微小区的基站缓存获得。</p>
<p>初步的研究[83]通过利用丰富的上下文信息（如用户内容浏览历史，社会关系），为异构网路小区基站提出了一个基于学习的传输cache方案,该方案能够通过利用前沿的ML以及方式技术更长远的拓展。</p>
<h2 id="D-AI-techniques-for-managing-machine-to-machine-M2M-communication-and-internrt-of-things-Iot-in-HetNet"><a href="#D-AI-techniques-for-managing-machine-to-machine-M2M-communication-and-internrt-of-things-Iot-in-HetNet" class="headerlink" title="D AI techniques for managing machine-to-machine(M2M) communication and internrt of things(Iot) in HetNet"></a>D AI techniques for managing machine-to-machine(M2M) communication and internrt of things(Iot) in HetNet</h2><p>HetNet不仅仅促进(facilitate)移动用户的移动贴心服务，也结合了M2M通信和Iot技术，其实现智能设备间的信息交互。如穿戴式无线传感器，建筑内，室外环境，甚至平常难以到达地区的嵌入式智能设备。但是，为了支持如此多数量的嵌入式设备，传统网络方法在高度异构的、可拓展的以及复杂的环境下，似乎不再适合。</p>
<h1 id="结论"><a href="#结论" class="headerlink" title="结论"></a>结论</h1><ul>
<li>结合基于AI的SON特征，异构网络有足够的潜能来增强移动服务性能</li>
</ul>
<h1 id="Words"><a href="#Words" class="headerlink" title="Words"></a>Words</h1><table>
<thead>
<tr>
<th>words</th>
<th>pronounce</th>
<th>meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td>taxonomy</td>
<td>tækˈsɑːnəmi</td>
<td>the scientific process of classifyingthings 分类</td>
</tr>
<tr>
<td>pending</td>
<td>ˈpendɪŋ</td>
<td>while waiting for something, or until something happens:</td>
</tr>
<tr>
<td>genetic</td>
<td>dʒɪˈnetɪk</td>
<td>connected with genes遗传</td>
</tr>
<tr>
<td>colony</td>
<td>ˈkɑːləni</td>
<td>a group of plants or animals that live together or grow in the same place 群</td>
</tr>
<tr>
<td>skyrocket</td>
<td>ˈskaɪˌrɒkət</td>
<td>if a price or an amount skyrockets, it greatly increases very quickly</td>
</tr>
<tr>
<td>substantially</td>
<td>səbˈstænʃəli</td>
<td>very much or a lot</td>
</tr>
<tr>
<td>compensation</td>
<td>ˌkɑːmpenˈseɪʃn</td>
<td>Compensation means “making up for a something，补偿</td>
</tr>
<tr>
<td>compact</td>
<td>ˈkɑːmpækt</td>
<td>smaller than is usual for things of the same kind</td>
</tr>
<tr>
<td>effectuate</td>
<td>ɪˈfektʃueɪt</td>
<td>to make sth happen</td>
</tr>
<tr>
<td>particle</td>
<td>ˈpɑːtɪkəl</td>
<td>a very small piece of something:</td>
<td>ˈmɪtɪɡeɪt     </td>
</tr>
<tr>
<td>mitigate</td>
<td>ˈmɪtɪɡeɪt</td>
<td>to make a situation or the effects of something less unpleasant, harmful, or serious</td>
</tr>
<tr>
<td>degradation</td>
<td>ˌdeɡrəˈdeɪʃn</td>
<td>the process of sth being damaged or made worse 恶化</td>
</tr>
<tr>
<td>on the fly</td>
<td></td>
<td>if you do sth on the fly,you do it quickly while sth else is happening</td>
</tr>
<tr>
<td>derivation</td>
<td>ˌderɪˈveɪʃən</td>
<td>the origin or development of sth, especially a word （尤指詞語的）起源，由來，派生</td>
</tr>
<tr>
<td>practically</td>
<td>ˈpræktɪkli</td>
<td>syn=almost</td>
</tr>
<tr>
<td>entail</td>
<td>ɪnˈteɪl</td>
<td>Entail means what something involves.</td>
</tr>
<tr>
<td>roam</td>
<td>roʊm</td>
<td>to walk or travel around an area without any definite aim or direction,漫游</td>
<td>rɪˈmiːdiəl</td>
</tr>
<tr>
<td>leverage</td>
<td>ˈlevərɪdʒ</td>
<td>to get as much advantage or profit as possible from sth that you have 充分利用</td>
</tr>
<tr>
<td>mutation</td>
<td>mjuːˈteɪʃən</td>
<td>a change in the form or structure of sth 突变</td>
</tr>
<tr>
<td>chromosome</td>
<td>ˈkroʊməsoʊm</td>
<td>A chromosome is a strand of DNA染色体</td>
</tr>
<tr>
<td>remedial</td>
<td>rɪˈmiːdiəl</td>
<td>intended to cure a problem with someone’s health补救</td>
</tr>
<tr>
<td>elastic</td>
<td>ɪˈlæstɪk</td>
<td>a type of rubber material that can stretch and then return to its usual length or 弹性</td>
</tr>
<tr>
<td>proliferation</td>
<td>prəˌlɪfəˈreɪʃn</td>
<td>the sudden increase in the number or amount of sth</td>
</tr>
<tr>
<td>facilitate</td>
<td>fəˈsɪlɪteɪt</td>
<td>to make an action or a process possible or easier</td>
</tr>
<tr>
<td>boost</td>
<td>buːst</td>
<td>to increase or improve something and make it more successful:</td>
</tr>
</tbody>
</table>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/ns3 Building a Wireless Network Topology/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Fatart's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/ns3 Building a Wireless Network Topology/" itemprop="url">ns3 Building a Wireless Network Topology</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-08-23T18:28:25+08:00">
                2017-08-23
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/NS3/" itemprop="url" rel="index">
                    <span itemprop="name">NS3</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>详细内容请参考<a href="https://www.nsnam.org/docs/release/3.26/tutorial/html/building-topologies.html" target="_blank" rel="external">ns-3 tutorial</a></p>
<h1 id="Models-Attributes-and-Reality"><a href="#Models-Attributes-and-Reality" class="headerlink" title="Models, Attributes and Reality"></a>Models, Attributes and Reality</h1><p>一个模型在定义上是现实的抽象。最终是由代码的作者决定所谓的“抽象的范围”以及“可用性”。</p>
<p>在某些情况下，比如csma，确定没有被建模的部分是相当容易的。通过阅读模块描述（csma.h）发现其没有冲突检测。</p>
<p>如你所见的，ns-3提供了一些用户能够直接改变模块行为的Attributes。考虑CsmaNetDevice的两个Attributes：MTU和EncapsulationMode。</p>
<p>MTU:Maximum Transmission Unit，这是Protocol Data Unit(PDU)的最大size。在CsmaNetDevice中，MTU默认值为1500bytes</p>
<h1 id="Building-a-Wireless-Network-Topology"><a href="#Building-a-Wireless-Network-Topology" class="headerlink" title="Building a Wireless Network Topology"></a>Building a Wireless Network Topology</h1><p>在这节，我们将拓展对ns-3 网络设备和信道的知识，涉及到组件一个无线网络。ns-3 提供了一系列802.11模型，该模型努力提供一个准确的802.11 MAC-level实现和一个“并不是特别慢”的802.11a PHY-Level实现。</p>
<p>在代码中，如果你改变了nCsma，它将会改变“extra” CSMA节点的数量。相似的，你可以设置nWifi来控制仿真中创建的STA(station)节点数量。在无线网络中有一个AP(Access point)。</p>
<h4 id="include-wifi-and-mobility-headfiles"><a href="#include-wifi-and-mobility-headfiles" class="headerlink" title="include wifi and mobility headfiles"></a>include wifi and mobility headfiles</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">#include &quot;ns3/core-module.h&quot;</div><div class="line">#include &quot;ns3/point-to-point-module.h&quot;</div><div class="line">#include &quot;ns3/network-module.h&quot;</div><div class="line">#include &quot;ns3/applications-module.h&quot;</div><div class="line">#include &quot;ns3/wifi-module.h&quot;</div><div class="line">#include &quot;ns3/mobility-module.h&quot;</div><div class="line">#include &quot;ns3/csma-module.h&quot;</div><div class="line">#include &quot;ns3/internet-module.h&quot;</div></pre></td></tr></table></figure>
<p>将创建的网络topology如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">// Default Network Topology</div><div class="line">//</div><div class="line">//   Wifi 10.1.3.0</div><div class="line">//                 AP</div><div class="line">//  *    *    *    *</div><div class="line">//  |    |    |    |    10.1.1.0</div><div class="line">// n5   n6   n7   n0 -------------- n1   n2   n3   n4(S)</div><div class="line">//          client   point-to-point  |    |    |    |</div><div class="line">//                                   ================</div><div class="line">//                                     LAN 10.1.2.0</div></pre></td></tr></table></figure>
<p>我们在p2p链路的左边添加了一个新的网络设备，为无线网络的AP(Access Point)，新的10.1.3.0 wifi网络具有nwifi个STA(station)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">using namespace ns3; //使用ns3 命名空间</div><div class="line"></div><div class="line">NS_LOG_COMPONENT_DEFINE (&quot;ThirdScriptExample&quot;); //定义log component</div></pre></td></tr></table></figure>
<p>添加command line parameter</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line">bool verbose = true;</div><div class="line">uint32_t nCsma = 3;</div><div class="line">uint32_t nWifi = 3;</div><div class="line"></div><div class="line">CommandLine cmd;</div><div class="line">cmd.AddValue (&quot;nCsma&quot;, &quot;Number of \&quot;extra\&quot; CSMA nodes/devices&quot;, nCsma);</div><div class="line">cmd.AddValue (&quot;nWifi&quot;, &quot;Number of wifi STA devices&quot;, nWifi);</div><div class="line">cmd.AddValue (&quot;verbose&quot;, &quot;Tell echo applications to log if true&quot;, verbose);</div><div class="line"></div><div class="line">cmd.Parse (argc,argv);</div><div class="line"></div><div class="line">if (verbose)</div><div class="line">  &#123;</div><div class="line">    LogComponentEnable(&quot;UdpEchoClientApplication&quot;, LOG_LEVEL_INFO);</div><div class="line">    LogComponentEnable(&quot;UdpEchoServerApplication&quot;, LOG_LEVEL_INFO);</div><div class="line">  &#125;</div><div class="line"></div><div class="line">NodeContainer p2pNodes;  </div><div class="line">p2pNodes.Create (2);  //创建两个p2p节点 N0 N1</div><div class="line"></div><div class="line">PointToPointHelper pointToPoint;</div><div class="line">pointToPoint.SetDeviceAttribute (&quot;DataRate&quot;, StringValue (&quot;5Mbps&quot;)); //设定device参数</div><div class="line">pointToPoint.SetChannelAttribute (&quot;Delay&quot;, StringValue (&quot;2ms&quot;)); //设定channel参数</div><div class="line"></div><div class="line">NetDeviceContainer p2pDevices;</div><div class="line">p2pDevices = pointToPoint.Install (p2pNodes); //安装p2p网络设备</div><div class="line"></div><div class="line">NodeContainer csmaNodes;</div><div class="line">csmaNodes.Add (p2pNodes.Get (1)); //在第二个p2p节点基础上创建一个csma节点 N1</div><div class="line">csmaNodes.Create (nCsma);         //创建“extra” csma node N2  N3 N4</div><div class="line"></div><div class="line">CsmaHelper csma;</div><div class="line">csma.SetChannelAttribute (&quot;DataRate&quot;, StringValue (&quot;100Mbps&quot;));</div><div class="line">csma.SetChannelAttribute (&quot;Delay&quot;, TimeValue (NanoSeconds (6560)));</div><div class="line"></div><div class="line">NetDeviceContainer csmaDevices;</div><div class="line">csmaDevices = csma.Install (csmaNodes); //安装csma网络设备</div><div class="line"></div><div class="line">NodeContainer wifiStaNodes;   //声明wifi节点</div><div class="line">wifiStaNodes.Create (nWifi);  //创建nwifi个 STA节点 N5 N6 N7</div><div class="line">NodeContainer wifiApNode = p2pNodes.Get (0); //在p2p第1个节点上创建一个wifiAp节点N0</div><div class="line"></div><div class="line">YansWifiChannelHelper channel = YansWifiChannelHelper::Default ();</div><div class="line">YansWifiPhyHelper phy = YansWifiPhyHelper::Default ();</div></pre></td></tr></table></figure>
<p>为了简单起见，代码使用了默认的PHY layer配置和channe 模型。</p>
<p>创建一个channel对象并将其和PHY layer对象联系起来，确保YansWifiPhyHelper创建的PHY level对象共享相同的底层信道，这样，他们共享相同信道才能通信和互相干扰。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">phy.SetChannel (channel.Create ());</div></pre></td></tr></table></figure>
<p>一旦PHY helper配置完成，我们将要配置MAC layer</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">WifiHelper wifi = WifiHelper::Default ();</div><div class="line">wifi.SetRemoteStationManager (&quot;ns3::AarfWifiManager&quot;); //使用 AARF algorithm</div><div class="line"></div><div class="line">NqosWifiMacHelper mac = NqosWifiMacHelper::Default ();</div></pre></td></tr></table></figure>
<p>配置type of MAC</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">Ssid ssid = Ssid (&quot;ns-3-ssid&quot;);</div><div class="line">mac.SetType (&quot;ns3::StaWifiMac&quot;,</div><div class="line">  &quot;Ssid&quot;, SsidValue (ssid),</div><div class="line">  &quot;ActiveProbing&quot;, BooleanValue (false));</div></pre></td></tr></table></figure>
<p>代码首先创建了一个802.11SSID(service set identifier)，我们用它来设定MAC layer的SSid的参数。</p>
<p>使用“ns3::StaWifiMac”设定mac layer的类型，这里是STA类型。</p>
<p>NqosWifiMacHelper将会确保创建的MAC对象不具备Attributs-QosSupported功能。</p>
<p>上面两点说明：创建了一个non-Qos non-AP station（STA）。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">NetDeviceContainer staDevices;</div><div class="line">staDevices = wifi.Install (phy, mac, wifiStaNodes); //在STA device上设定phy，mac，node</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">mac.SetType (&quot;ns3::ApWifiMac&quot;,          //设定Ap 类型的mac</div><div class="line">             &quot;Ssid&quot;, SsidValue (ssid));</div><div class="line">NetDeviceContainer apDevices;</div><div class="line">apDevices = wifi.Install (phy, mac, wifiApNode); //安装于AP node之上</div></pre></td></tr></table></figure>
<h3 id="移动模块"><a href="#移动模块" class="headerlink" title="移动模块"></a>移动模块</h3><p>我们希望STA节点是移动的，在一个有限的box里移动。我们希望AP node是固定的，使用MobilityHelper实现。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">MobilityHelper mobility;</div><div class="line"></div><div class="line">mobility.SetPositionAllocator (&quot;ns3::GridPositionAllocator&quot;,</div><div class="line">  &quot;MinX&quot;, DoubleValue (0.0),</div><div class="line">  &quot;MinY&quot;, DoubleValue (0.0),</div><div class="line">  &quot;DeltaX&quot;, DoubleValue (5.0),</div><div class="line">  &quot;DeltaY&quot;, DoubleValue (10.0),</div><div class="line">  &quot;GridWidth&quot;, UintegerValue (3),</div><div class="line">  &quot;LayoutType&quot;, StringValue (&quot;RowFirst&quot;));</div></pre></td></tr></table></figure>
<p>告知MobilityHelper使用一个2维grid来初始放置STA节点。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">mobility.SetMobilityModel (&quot;ns3::RandomWalk2dMobilityModel&quot;,</div><div class="line">  &quot;Bounds&quot;, RectangleValue (Rectangle (-50, 50, -50, 50)));</div><div class="line">  </div><div class="line">  mobility.Install (wifiStaNodes);</div></pre></td></tr></table></figure>
<p>We have arranged our nodes on an initial grid, but now we need to tell them how to move. We choose the RandomWalk2dMobilityModel which has the nodes move in a random direction at a random speed around inside a bounding box.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">mobility.SetMobilityModel (&quot;ns3::ConstantPositionMobilityModel&quot;);</div><div class="line">mobility.Install (wifiApNode);</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">InternetStackHelper stack;</div><div class="line">stack.Install (csmaNodes);</div><div class="line">stack.Install (wifiApNode);</div><div class="line">stack.Install (wifiStaNodes);</div></pre></td></tr></table></figure>
<p>install stack</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">Ipv4AddressHelper address;</div><div class="line"></div><div class="line">address.SetBase (&quot;10.1.1.0&quot;, &quot;255.255.255.0&quot;);</div><div class="line">Ipv4InterfaceContainer p2pInterfaces;</div><div class="line">p2pInterfaces = address.Assign (p2pDevices);</div><div class="line"></div><div class="line">address.SetBase (&quot;10.1.2.0&quot;, &quot;255.255.255.0&quot;);</div><div class="line">Ipv4InterfaceContainer csmaInterfaces;</div><div class="line">csmaInterfaces = address.Assign (csmaDevices);</div><div class="line"></div><div class="line">address.SetBase (&quot;10.1.3.0&quot;, &quot;255.255.255.0&quot;);</div><div class="line">address.Assign (staDevices); //先分配的stadevice 所以 sta地址从 10.1.3.1~ 10.1.3.3</div><div class="line">address.Assign (apDevices);  //ap IP 10.1.3.4</div></pre></td></tr></table></figure>
<p>assign IP</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">UdpEchoServerHelper echoServer (9);</div><div class="line"></div><div class="line">ApplicationContainer serverApps = echoServer.Install (csmaNodes.Get (nCsma));</div><div class="line">serverApps.Start (Seconds (1.0));</div><div class="line">serverApps.Stop (Seconds (10.0));</div><div class="line">UdpEchoClientHelper echoClient (csmaInterfaces.GetAddress (nCsma), 9);</div><div class="line">echoClient.SetAttribute (&quot;MaxPackets&quot;, UintegerValue (1));</div><div class="line">echoClient.SetAttribute (&quot;Interval&quot;, TimeValue (Seconds (1.0)));</div><div class="line">echoClient.SetAttribute (&quot;PacketSize&quot;, UintegerValue (1024));</div><div class="line"></div><div class="line">ApplicationContainer clientApps =</div><div class="line">  echoClient.Install (wifiStaNodes.Get (nWifi - 1));</div><div class="line">clientApps.Start (Seconds (2.0));</div><div class="line">clientApps.Stop (Seconds (10.0));</div></pre></td></tr></table></figure>
<p>install AP</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Ipv4GlobalRoutingHelper::PopulateRoutingTables ();</div></pre></td></tr></table></figure>
<p>enable global routing</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">pointToPoint.EnablePcapAll (&quot;third&quot;);</div><div class="line">phy.EnablePcap (&quot;third&quot;, apDevices.Get (0));</div><div class="line">csma.EnablePcap (&quot;third&quot;, csmaDevices.Get (0), true);</div></pre></td></tr></table></figure>
<p>enable pcap</p>
<h2 id="运行代码"><a href="#运行代码" class="headerlink" title="运行代码"></a>运行代码</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ ./waf --run scratch/third</div><div class="line"></div><div class="line">$ ./waf --run scratch/third --vis  //带python图像</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">At time 2s client sent 1024 bytes to 10.1.2.4 port 9</div><div class="line">At time 2.01796s server received 1024 bytes from 10.1.3.3 port 49153</div><div class="line">At time 2.01796s server sent 1024 bytes to 10.1.3.3 port 49153</div><div class="line">At time 2.03364s client received 1024 bytes from 10.1.2.4 port 9</div></pre></td></tr></table></figure>
<p>在文件夹里存在4个pcap文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">third-0-0.pcap  third-0-1.pcap  third-1-0.pcap  third-1-1.pcap</div></pre></td></tr></table></figure>
<p>third-0-0.pcap： Node 0 - PointToPoint Netdevice<br>third-0-1.pcap： Node 0 - Wifi Netdevice<br>third-1-0.pcap： Node 1 - PointToPoint Netdevice<br>third-1-1.pcap： Node 1 - Csma Netdevice</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line">$ tcpdump -nn -tt -r third-0-1.pcap</div><div class="line">reading from file third-0-1.pcap, link-type IEEE802_11 (802.11)</div><div class="line">0.000025 Beacon (ns-3-ssid) [6.0* 9.0 12.0 18.0 24.0 36.0 48.0 54.0 Mbit] IBSS</div><div class="line">0.000308 Assoc Request (ns-3-ssid) [6.0 9.0 12.0 18.0 24.0 36.0 48.0 54.0 Mbit]</div><div class="line">0.000324 Acknowledgment RA:00:00:00:00:00:08</div><div class="line">0.000402 Assoc Response AID(0) :: Successful</div><div class="line">0.000546 Acknowledgment RA:00:00:00:00:00:0a</div><div class="line">0.000721 Assoc Request (ns-3-ssid) [6.0 9.0 12.0 18.0 24.0 36.0 48.0 54.0 Mbit]</div><div class="line">0.000737 Acknowledgment RA:00:00:00:00:00:07</div><div class="line">0.000824 Assoc Response AID(0) :: Successful</div><div class="line">0.000968 Acknowledgment RA:00:00:00:00:00:0a</div><div class="line">0.001134 Assoc Request (ns-3-ssid) [6.0 9.0 12.0 18.0 24.0 36.0 48.0 54.0 Mbit]</div><div class="line">0.001150 Acknowledgment RA:00:00:00:00:00:09</div><div class="line">0.001273 Assoc Response AID(0) :: Successful</div><div class="line">0.001417 Acknowledgment RA:00:00:00:00:00:0a</div><div class="line">0.102400 Beacon (ns-3-ssid) [6.0* 9.0 12.0 18.0 24.0 36.0 48.0 54.0 Mbit] IBSS</div><div class="line">0.204800 Beacon (ns-3-ssid) [6.0* 9.0 12.0 18.0 24.0 36.0 48.0 54.0 Mbit] IBSS</div><div class="line">0.307200 Beacon (ns-3-ssid) [6.0* 9.0 12.0 18.0 24.0 36.0 48.0 54.0 Mbit] IBSS</div><div class="line"></div><div class="line">$ tcpdump -nn -tt -r third-0-0.pcap</div><div class="line">reading from file third-0-0.pcap, link-type PPP (PPP)</div><div class="line">2.008151 IP 10.1.3.3.49153 &gt; 10.1.2.4.9: UDP, length 1024</div><div class="line">2.026758 IP 10.1.2.4.9 &gt; 10.1.3.3.49153: UDP, length 1024</div><div class="line"></div><div class="line">$ tcpdump -nn -tt -r third-1-0.pcap</div><div class="line">reading from file third-1-0.pcap, link-type PPP (PPP)</div><div class="line">2.011837 IP 10.1.3.3.49153 &gt; 10.1.2.4.9: UDP, length 1024</div><div class="line">2.023072 IP 10.1.2.4.9 &gt; 10.1.3.3.49153: UDP, length 1024</div><div class="line"></div><div class="line">$ tcpdump -nn -tt -r third-1-1.pcap</div><div class="line">reading from file third-1-1.pcap, link-type EN10MB (Ethernet)</div><div class="line">2.017837 ARP, Request who-has 10.1.2.4 (ff:ff:ff:ff:ff:ff) tell 10.1.2.1, length 50</div><div class="line">2.017861 ARP, Reply 10.1.2.4 is-at 00:00:00:00:00:06, length 50</div><div class="line">2.017861 IP 10.1.3.3.49153 &gt; 10.1.2.4.9: UDP, length 1024</div><div class="line">2.022966 ARP, Request who-has 10.1.2.1 (ff:ff:ff:ff:ff:ff) tell 10.1.2.4, length 50</div><div class="line">2.022966 ARP, Reply 10.1.2.1 is-at 00:00:00:00:00:03, length 50</div><div class="line">2.023072 IP 10.1.2.4.9 &gt; 10.1.3.3.49153: UDP, length 1024</div></pre></td></tr></table></figure>
<h1 id="修改MobilityModel-trace-source"><a href="#修改MobilityModel-trace-source" class="headerlink" title="修改MobilityModel trace source"></a>修改MobilityModel trace source</h1><p>我们通过和MobilityModel的 course change trace source</p>
<p>ns3 trace system 分成 trace source 和 trace sinks，我们提供函数连接这两个。我们将使用mobility model预先定义的course change trace souce来发起trace 时间。</p>
<p>我们将需要写一个trace sink和source连接，这个sink将会为我们显式一些数据。</p>
<p>我们可以在<a href="https://www.nsnam.org/docs/release/3.26/doxygen/classns3_1_1_mobility_model.html" target="_blank" rel="external">API</a>中，找到mobility model的trace source。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">TraceSources</div><div class="line">- CourseChange ：The value of the position and/or velocity vector changed</div><div class="line">Callback signature: ns3::MobilityModel::TracedCallback</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Config Paths</div><div class="line"></div><div class="line">ns3::MobilityModel is accessible through the following paths with Config::Set and Config::Connect:</div><div class="line"></div><div class="line">&quot;/NodeList/[i]/$ns3::MobilityModel&quot;</div></pre></td></tr></table></figure>
<p>在 NS_LOG_COMPONENT_DEFINE后添加如下代码（trace sink）：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">void</div><div class="line">CourseChange (std::string context, Ptr&lt;const MobilityModel&gt; model)</div><div class="line">&#123;</div><div class="line">  Vector position = model-&gt;GetPosition ();</div><div class="line">  NS_LOG_UNCOND (context &lt;&lt;</div><div class="line">    &quot; x = &quot; &lt;&lt; position.x &lt;&lt; &quot;, y = &quot; &lt;&lt; position.y);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>我们会在每一此STA位置变化的情况下输出位置，使用用Config::Connect，在Simulator::Run前加：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">std::ostringstream oss;</div><div class="line">oss &lt;&lt;</div><div class="line">  &quot;/NodeList/&quot; &lt;&lt; wifiStaNodes.Get (nWifi - 1)-&gt;GetId () &lt;&lt;</div><div class="line">  &quot;/$ns3::MobilityModel/CourseChange&quot;;</div><div class="line"></div><div class="line">Config::Connect (oss.str (), MakeCallback (&amp;CourseChange));</div></pre></td></tr></table></figure>
<p>在<a href="https://www.nsnam.org/docs/release/3.26/doxygen/group__config.html#ga4014f151241cd0939b6cb64409605736" target="_blank" rel="external">API</a>中查看得到的connect函数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">void ns3::Config::Connect(std::string path, const CallbackBase &amp; cb)</div><div class="line"></div><div class="line">Parameters</div><div class="line">   [in] path  A path to match trace sources</div><div class="line">   [in] cb    The callback to connect to the matching trace sources</div></pre></td></tr></table></figure>
<p>我们可以看到在代码中第一个输入参数为 trace source的访问链接，使用ostringstream::str得到例如以下的形式（和API中的形式一致），指向的是NodeList的第7个节点</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/NodeList/7/$ns3::MobilityModel/CourseChange</div></pre></td></tr></table></figure>
<p>我们将node 7 的trace source和我们编写的trace sink函数（coursechange）链接起来，使用Config::Connect函数。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line">&apos;build&apos; finished successfully (5.989s)</div><div class="line">/NodeList/7/$ns3::MobilityModel/CourseChange x = 10, y = 0</div><div class="line">/NodeList/7/$ns3::MobilityModel/CourseChange x = 10.3841, y = 0.923277</div><div class="line">/NodeList/7/$ns3::MobilityModel/CourseChange x = 10.2049, y = 1.90708</div><div class="line">/NodeList/7/$ns3::MobilityModel/CourseChange x = 10.8136, y = 1.11368</div><div class="line">/NodeList/7/$ns3::MobilityModel/CourseChange x = 10.8452, y = 2.11318</div><div class="line">/NodeList/7/$ns3::MobilityModel/CourseChange x = 10.9797, y = 3.10409</div><div class="line">At time 2s client sent 1024 bytes to 10.1.2.4 port 9</div><div class="line">At time 2.01796s server received 1024 bytes from 10.1.3.3 port 49153</div><div class="line">At time 2.01796s server sent 1024 bytes to 10.1.3.3 port 49153</div><div class="line">At time 2.03364s client received 1024 bytes from 10.1.2.4 port 9</div><div class="line">/NodeList/7/$ns3::MobilityModel/CourseChange x = 11.3273, y = 4.04175</div><div class="line">/NodeList/7/$ns3::MobilityModel/CourseChange x = 12.013, y = 4.76955</div><div class="line">/NodeList/7/$ns3::MobilityModel/CourseChange x = 12.4317, y = 5.67771</div><div class="line">/NodeList/7/$ns3::MobilityModel/CourseChange x = 11.4607, y = 5.91681</div><div class="line">/NodeList/7/$ns3::MobilityModel/CourseChange x = 12.0155, y = 6.74878</div><div class="line">/NodeList/7/$ns3::MobilityModel/CourseChange x = 13.0076, y = 6.62336</div><div class="line">/NodeList/7/$ns3::MobilityModel/CourseChange x = 12.6285, y = 5.698</div><div class="line">/NodeList/7/$ns3::MobilityModel/CourseChange x = 13.32, y = 4.97559</div><div class="line">/NodeList/7/$ns3::MobilityModel/CourseChange x = 13.1134, y = 3.99715</div><div class="line">/NodeList/7/$ns3::MobilityModel/CourseChange x = 13.8359, y = 4.68851</div><div class="line">/NodeList/7/$ns3::MobilityModel/CourseChange x = 13.5953, y = 3.71789</div><div class="line">/NodeList/7/$ns3::MobilityModel/CourseChange x = 12.7595, y = 4.26688</div><div class="line">/NodeList/7/$ns3::MobilityModel/CourseChange x = 11.7629, y = 4.34913</div><div class="line">/NodeList/7/$ns3::MobilityModel/CourseChange x = 11.2292, y = 5.19485</div><div class="line">/NodeList/7/$ns3::MobilityModel/CourseChange x = 10.2344, y = 5.09394</div><div class="line">/NodeList/7/$ns3::MobilityModel/CourseChange x = 9.3601, y = 4.60846</div><div class="line">/NodeList/7/$ns3::MobilityModel/CourseChange x = 8.40025, y = 4.32795</div><div class="line">/NodeList/7/$ns3::MobilityModel/CourseChange x = 9.14292, y = 4.99761</div><div class="line">/NodeList/7/$ns3::MobilityModel/CourseChange x = 9.08299, y = 5.99581</div><div class="line">/NodeList/7/$ns3::MobilityModel/CourseChange x = 8.26068, y = 5.42677</div><div class="line">/NodeList/7/$ns3::MobilityModel/CourseChange x = 8.35917, y = 6.42191</div><div class="line">/NodeList/7/$ns3::MobilityModel/CourseChange x = 7.66805, y = 7.14466</div><div class="line">/NodeList/7/$ns3::MobilityModel/CourseChange x = 6.71414, y = 6.84456</div><div class="line">/NodeList/7/$ns3::MobilityModel/CourseChange x = 6.42489, y = 7.80181</div></pre></td></tr></table></figure>
<h1 id="Config-path-Tips"><a href="#Config-path-Tips" class="headerlink" title="Config path Tips"></a>Config path Tips</h1><p>Suppose you type in:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">oss &lt;&lt; &quot;/NodeList/&quot; &lt;&lt; wifiStaNodes.Get (nWifi - 1)-&gt;GetId () &lt;&lt; “$ns-3::MobilityModel/CourseChange&quot;;</div></pre></td></tr></table></figure>
<p>instead of </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">oss &lt;&lt; &quot;/NodeList/&quot; &lt;&lt; wifiStaNodes.Get (nWifi - 1)-&gt;GetId () &lt;&lt; &quot;/$ns-3::MobilityModel/CourseChange&quot;;</div></pre></td></tr></table></figure>
<p><strong>With the first version： no error message， but none of the “/NodeList/7/$ns-3::MobilityModel/CourseChange x = …, y = …” are printed out!!</strong></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/Modal verb-would have, could have, should have/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Fatart's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/Modal verb-would have, could have, should have/" itemprop="url">Modal verb-would have, could have, should have</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-08-21T19:06:44+08:00">
                2017-08-21
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/TOEFL/" itemprop="url" rel="index">
                    <span itemprop="name">TOEFL</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><a href="https://learningenglish.voanews.com/pp/3391163/ppt0.html" target="_blank" rel="external">voice player</a></p>
<p>Today we will take a look at the <strong>modal</strong> verbs could have, would have and should have. These past tense modals are useful for expressing your present feelings about a past decision (or other action).</p>
<p><em>Could have</em>, <em>would have</em>, and <em>should have</em> are sometimes called “modals of lost opportunities.” They work like a grammatical time machine. The simple past just tells what happened. Past modals tell what could have, would have, and should have happened.</p>
<p>To form these past modals, use could, would, or should followed by have, followed by a past participle verb. Use have for all pronouns; never use has or had to form a past modal. Here are some examples:</p>
<ul>
<li><p>She could have gone to any college she wanted to. </p>
<p>她本来能够去她想去的大学</p>
</li>
<li><p>I would have gone to the party, but I was tired.</p>
<p>我本想去party，但我累了。</p>
</li>
<li><p>He should have told the truth about what he saw.</p>
<p>他本该说出他看到的。</p>
</li>
</ul>
<p>Each of these modals has a slightly different meaning. We’ll look at each of them using examples from movies and popular songs.</p>
<h1 id="Could-have-本来能够"><a href="#Could-have-本来能够" class="headerlink" title="Could have 本来能够"></a>Could have 本来能够</h1><p>We’ll start with <em>could have</em>. <em>Could have</em> means that something was possible in the past, but it did not happen.</p>
<ul>
<li>I could have gone directly to college, but I decided to travel for a year.</li>
</ul>
<p>Listen to this song by 1980s teen pop star Tiffany. The singer is thinking about past possibilities with her lost love.</p>
<ul>
<li><p>Could have been so beautiful</p>
</li>
<li><p>Could have been so right</p>
</li>
<li><p>Could have been my lover</p>
</li>
<li><p>Every day of my life</p>
</li>
</ul>
<p>Native speakers often do not pronounce their past tense modals as clearly as Tiffany. Could have been usually gets <em>contracted</em> to could’ve been or even coulda’ been.</p>
<p>Listen to Marlon Brando in the classic film “On the <strong>Waterfront</strong>.” Brando’s character, Terry Malloy, was once a promising young boxer.</p>
<ul>
<li>“You don’t understand. I coulda’ had class. I coulda’ been a <strong>contender</strong>. I could have been somebody—instead of a <strong>bum</strong>.”</li>
</ul>
<p>To form the negative with these modals, use not between could and have. Could not have means that something was impossible in the past. For example:</p>
<ul>
<li><p>She could not have been on that flight because I just saw her at work.</p>
<p>她绝不可能在飞机上，因为我看见她在工作。</p>
</li>
</ul>
<p>Defense lawyers often use could not have to argue for a client’s innocence.</p>
<p>A popular <strong>compliment</strong> in English is, “<strong>I couldn’t have said it better myself.</strong>” You can say this when you like the way somebody said something. It is a way to show strong agreement.</p>
<h1 id="Would-have"><a href="#Would-have" class="headerlink" title="Would have"></a>Would have</h1><p>Let’s move on to would have.</p>
<p>Would have is a bit more difficult because it has two common structures. The first is with but. I would have A, but I had to B. Use this structure to show that you wanted to do something in the past, but you could not.</p>
<ul>
<li><p>I would have called, <em>but</em> there was no phone service.</p>
<p>我本想打电话，但那里无服务。</p>
</li>
<li><p>I would have loaned you the money, ++but++ I didn’t have any.</p>
<p>我本想贷你钱，但我自己都没有。</p>
</li>
</ul>
<p>Would have also forms the result clause of a past unreal conditional.过去没发生的事情</p>
<h3 id="For-example"><a href="#For-example" class="headerlink" title="For example:"></a>For example:</h3><ul>
<li><p>If I had known they were vegetarians, I would have made a salad.</p>
<p> 如果我知道他们都是素食主义者，我就做一些沙拉了。</p>
</li>
</ul>
<p>You can always reverse conditional sentences. If would have comes first, there is no comma.</p>
<ul>
<li><p>I would have made a salad if I had known they were vegetarians.</p>
<p>如果我知道他们都是素食主义者，我就做一些沙拉了</p>
</li>
</ul>
<p>Past unreal conditionals are very complex; you can learn more about them on a previous episode of <a href="https://learningenglish.voanews.com/a/past-unreal-conditionals/3181755.html" target="_blank" rel="external">Everyday Grammar</a>.</p>
<p>Usually, <em>would have</em> suggests a bad feeling about the past. But not always. In this song by the band Chicago, the singer is surprisingly happy that his ex-girlfriend cheated on him. Her <strong>infidelity</strong> gave him the opportunity to meet someone else. And that someone else turned out to be his true love.</p>
<ul>
<li><p>If she would have been faithful</p>
</li>
<li><p>If she could have been true</p>
</li>
<li><p>Then I wouldn’ta been cheated</p>
</li>
<li><p>I would never know real love</p>
</li>
<li><p>I would’ve missed out on you</p>
</li>
</ul>
<h1 id="Should-have"><a href="#Should-have" class="headerlink" title="Should have"></a>Should have</h1><p>Finally, let’s look at should have. Should have means that something did not happen, but we wish it had happened. We use should have to talk about past mistakes. A worried mother might say:</p>
<ul>
<li>“I was so worried about you. You should have called!”</li>
</ul>
<p>Should have is common in apologies. For example:</p>
<ul>
<li>I’m sorry that I’m late for work. I should have woken up earlier.</li>
</ul>
<p>You might remember Lieutenant Dan in the movie Forrest Gump. In the movie, Dan loses both of his legs in the Vietnam War. He would have died, but Forrest saved him.</p>
<p>Listen for should have as Dan <strong>confronts</strong> Forrest.</p>
<p>“You listen to me. We all have a <strong>destiny</strong>. Nothing just happens. It’s all part of a plan. I should have died out there with my men. But now I’m nothing but a <strong>cripple</strong>!”</p>
<p>Should have can be used in a light-hearted way. In this song, country singer Toby Keith imagines how exciting his life would be if he had chosen to be a cowboy.</p>
<ul>
<li><p>I should’ve been a cowboy</p>
</li>
<li><p>I should’ve learned to rope and ride</p>
</li>
<li><p>Wearing my <strong>six-shooter</strong></p>
</li>
<li><p>Riding my pony on a cattle drive</p>
</li>
</ul>
<p>I couldn’t have said it better myself. As you can see, these modals of lost opportunities offer a colorful way to talk about past choices.</p>
<p><img src="https://gdb.voanews.com/E3483FCB-75A1-477C-B1B5-2EC244003527_w650_r0_s.png" alt="image"></p>
<h1 id="Words-in-This-Story"><a href="#Words-in-This-Story" class="headerlink" title="Words in This Story"></a>Words in This Story</h1><ul>
<li><p>modal verb /ˈmoʊdl/ – n. a verb (such as can, could, shall, should, ought to, will, or would) that is usually used with another verb to express ideas such as possibility, necessity, and permission\</p>
</li>
<li><p>waterfront /ˈwɑːtərfrʌnt/ - n. a part of a town or an area that is next to water</p>
</li>
<li><p>contender /kənˈtendər/ – n. a person who tries to win something in a game or competition</p>
</li>
<li><p>bum /bʌm/ – n. a person who is lazy or who does something badly</p>
</li>
<li><p>compliment /ˈkɒmplɪmənt/ – n. a comment that says something good about someone or something</p>
</li>
<li><p>destiny /ˈdestɪni/ - n. the things that will happen to someone in the future, especially those that cannot be changed or controlled, syn = fate</p>
</li>
<li><p>vegetarian /ˌvedʒɪˈteəriən/ – n. a person who does not eat meat</p>
</li>
<li><p>infidelity /ˌɪnfɪˈdeləti/ – n. the act or fact of having a romantic or sexual relationship with someone other than your husband, wife, or partner</p>
</li>
<li><p>confront /kənˈfrʌnt/ – v. to oppose someone, especially in a direct and forceful way</p>
</li>
<li><p>cripple /ˈkrɪpəl/ – n. a person who cannot move or walk normally because of a permanent injury or other physical problem</p>
</li>
<li><p>six-shooter /ˈʃuːtə / – n. a kind of gun (called a revolver) that can hold six bullets (often used to describe guns used in the old American West)</p>
</li>
<li><p>cattle drive /ˈkætl/ – n. the process of moving cows from one place to another</p>
</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/ns3 Building Topologies/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Fatart's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/ns3 Building Topologies/" itemprop="url">ns3 Building Topologies second.cc</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-08-21T18:28:25+08:00">
                2017-08-21
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/NS3/" itemprop="url" rel="index">
                    <span itemprop="name">NS3</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>详细内容请参考<a href="https://www.nsnam.org/docs/release/3.26/tutorial/html/building-topologies.html" target="_blank" rel="external">ns-3 tutorial</a></p>
<h1 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h1><p>ns-3的CSMA device以一个简单以太网建模。一个实际的以太网使用CSMA/CD（Carrier Sense Multiple Access with Collision Detection）方案，有着指数增加的回退backoff以竞争（contend for）共享的传输媒介。</p>
<p>The file opens in  second.cc.</p>
<h4 id="首先还是include-一些头文件"><a href="#首先还是include-一些头文件" class="headerlink" title="首先还是include 一些头文件"></a>首先还是include 一些头文件</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">#include &quot;ns3/core-module.h&quot;</div><div class="line">#include &quot;ns3/network-module.h&quot;</div><div class="line">#include &quot;ns3/csma-module.h&quot;</div><div class="line">#include &quot;ns3/internet-module.h&quot;</div><div class="line">#include &quot;ns3/point-to-point-module.h&quot;</div><div class="line">#include &quot;ns3/applications-module.h&quot;</div><div class="line">#include &quot;ns3/ipv4-global-routing-helper.h&quot;</div></pre></td></tr></table></figure>
<h4 id="可见将要创建的网络拓扑如下所示"><a href="#可见将要创建的网络拓扑如下所示" class="headerlink" title="可见将要创建的网络拓扑如下所示"></a>可见将要创建的网络拓扑如下所示</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">// Default Network Topology</div><div class="line">//</div><div class="line">//       10.1.1.0</div><div class="line">// n0 -------------- n1   n2   n3   n4</div><div class="line">//    point-to-point  |    |    |    |</div><div class="line">//                    ================</div><div class="line">//                      LAN 10.1.2.0</div></pre></td></tr></table></figure>
<p>使用命名空间，并定义Log_Component</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">using namespace ns3;</div><div class="line"></div><div class="line">NS_LOG_COMPONENT_DEFINE (&quot;SecondScriptExample&quot;);</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">bool verbose = true;</div><div class="line">uint32_t nCsma = 3;</div><div class="line"></div><div class="line">CommandLine cmd;</div><div class="line">cmd.AddValue (&quot;nCsma&quot;, &quot;Number of \&quot;extra\&quot; CSMA nodes/devices&quot;, nCsma);</div><div class="line">cmd.AddValue (&quot;verbose&quot;, &quot;Tell echo applications to log if true&quot;, verbose);</div><div class="line"></div><div class="line">cmd.Parse (argc, argv);</div><div class="line"></div><div class="line">if (verbose)</div><div class="line">  &#123;</div><div class="line">    LogComponentEnable(&quot;UdpEchoClientApplication&quot;, LOG_LEVEL_INFO);</div><div class="line">    LogComponentEnable(&quot;UdpEchoServerApplication&quot;, LOG_LEVEL_INFO);</div><div class="line">  &#125;</div><div class="line"></div><div class="line">nCsma = nCsma == 0 ? 1 : nCsma;</div></pre></td></tr></table></figure>
<p>定义一个verbose flag来开启或关闭，UdpEchoClientApp和UdoEchoServerApp</p>
<p>为command line argument system 添加一个 nCsma 参数，代表 其他csma设备数量</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">NodeContainer p2pNodes;</div><div class="line">p2pNodes.Create (2);</div></pre></td></tr></table></figure>
<p>创建两个p2p node</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">NodeContainer csmaNodes;</div><div class="line">csmaNodes.Add (p2pNodes.Get (1)); //在一个p2p节点上创建一个csma节点</div><div class="line">csmaNodes.Create (nCsma);         //创建nCsma个节点</div></pre></td></tr></table></figure>
<p>在<a href="https://www.nsnam.org/docs/release/3.26/doxygen/classns3_1_1_node_container.html#a9ed96e2ecc22e0f5a3d4842eb9bf90bf" target="_blank" rel="external">API</a>中，查看Get 函数。</p>
<p><strong>Ptr&lt; Node &gt; ns3::NodeContainer::Get    (    uint32_t     i    )    const</strong></p>
<p>Get the Ptr<node> stored in this container at a given index.<br>使用一个给定的index得到存在container中的Ptr<node>智能指针。</node></node></p>
<p><strong>Parameters</strong></p>
<p> i    the index of the requested node pointer.</p>
<p><strong>Returns</strong></p>
<p>the requested node pointer.</p>
<p>Nodes can be retrieved from the container in two ways. First, directly by an index into the container, and second, using an iterator. This method is used in the direct method and is used to retrieve the indexed Ptr<appliation>.</appliation></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">uint32_t nNodes = container.GetN ();  //得到container中存在的节点数目</div><div class="line">for (uint32_t i = 0 i &lt; nNodes; ++i)</div><div class="line">  &#123;</div><div class="line">    Ptr&lt;Node&gt; p = container.Get (i)</div><div class="line">    i-&gt;method ();  // some Node method</div><div class="line">  &#125;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">PointToPointHelper pointToPoint;  </div><div class="line">pointToPoint.SetDeviceAttribute (&quot;DataRate&quot;, StringValue (&quot;5Mbps&quot;));</div><div class="line">pointToPoint.SetChannelAttribute (&quot;Delay&quot;, StringValue (&quot;2ms&quot;));</div><div class="line"></div><div class="line">NetDeviceContainer p2pDevices;</div><div class="line">p2pDevices = pointToPoint.Install (p2pNodes);</div></pre></td></tr></table></figure>
<p>初始化一个PointToPointHelper对象，并设置Device和Channel参数，DataRate 5Mbps 和 Delay 2ms。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">CsmaHelper csma;</div><div class="line">csma.SetChannelAttribute (&quot;DataRate&quot;, StringValue (&quot;100Mbps&quot;));</div><div class="line">csma.SetChannelAttribute (&quot;Delay&quot;, TimeValue (NanoSeconds (6560)));</div><div class="line"></div><div class="line">NetDeviceContainer csmaDevices;</div><div class="line">csmaDevices = csma.Install (csmaNodes);  </div><div class="line"></div><div class="line">InternetStackHelper stack;</div><div class="line">stack.Install (p2pNodes.Get (0));</div><div class="line">stack.Install (csmaNodes);</div><div class="line"></div><div class="line">//使用IPv4AddressHelper分配Ip地址</div><div class="line"></div><div class="line">Ipv4AddressHelper address;</div><div class="line">address.SetBase (&quot;10.1.1.0&quot;, &quot;255.255.255.0&quot;);</div><div class="line">Ipv4InterfaceContainer p2pInterfaces;</div><div class="line">p2pInterfaces = address.Assign (p2pDevices);</div><div class="line"></div><div class="line">address.SetBase (&quot;10.1.2.0&quot;, &quot;255.255.255.0&quot;);</div><div class="line">Ipv4InterfaceContainer csmaInterfaces;</div><div class="line">csmaInterfaces = address.Assign (csmaDevices);</div></pre></td></tr></table></figure>
<p>在API中查看<a href="https://www.nsnam.org/docs/release/3.26/doxygen/classns3_1_1_ipv4_address_helper.html" target="_blank" rel="external">Ipv4AddressHelper</a>,和<a href="https://www.nsnam.org/docs/release/3.26/doxygen/classns3_1_1_ipv4_interface_container.html#af501b5fa9d6e1cc316ba259609da608e" target="_blank" rel="external">Ipv4InterfaceContainer</a>.</p>
<p>添加APP</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">UdpEchoServerHelper echoServer (9);</div><div class="line"></div><div class="line">ApplicationContainer serverApps = echoServer.Install (csmaNodes.Get (nCsma));</div><div class="line">serverApps.Start (Seconds (1.0));</div><div class="line">serverApps.Stop (Seconds (10.0));</div></pre></td></tr></table></figure>
<p>在前文 csma container 装有一个p2p node 和 nCsma 个 extra nodes。</p>
<p>所以</p>
<ul>
<li><p>.Get(0) -&gt; p2p node ptr</p>
</li>
<li><p>.Get(1) -&gt; 第一个csma node ptr</p>
</li>
<li><p>.Get(nCsma) -&gt; 第nCsma个csma node ptr,最后一个csma节点指针</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">UdpEchoClientHelper echoClient (csmaInterfaces.GetAddress (nCsma), 9);</div><div class="line">echoClient.SetAttribute (&quot;MaxPackets&quot;, UintegerValue (1));</div><div class="line">echoClient.SetAttribute (&quot;Interval&quot;, TimeValue (Seconds (1.0)));</div><div class="line">echoClient.SetAttribute (&quot;PacketSize&quot;, UintegerValue (1024));</div><div class="line"></div><div class="line">ApplicationContainer clientApps = echoClient.Install (p2pNodes.Get (0));</div><div class="line">clientApps.Start (Seconds (2.0));</div><div class="line">clientApps.Stop (Seconds (10.0));</div></pre></td></tr></table></figure>
<p>使用全局路由</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Ipv4GlobalRoutingHelper::PopulateRoutingTables ();</div></pre></td></tr></table></figure>
<p>开启Pcap追踪</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">pointToPoint.EnablePcapAll (&quot;second&quot;);</div><div class="line">csma.EnablePcap (&quot;second&quot;, csmaDevices.Get (1), true);</div></pre></td></tr></table></figure>
<p>CSMA 网络是一个多点对点网络。这就意味着多个终端使用一个共享媒介。每一个终端都有一个对应的网络设备。对于这样的网络，有两种基本的方法来搜集trace信息。</p>
<p>一种方法就是为每一个网络设备创立一个trace file并存储其发送和接收的数据包；</p>
<p>第二种方法就是在有所设备中选择一个网络设备，并将其设为promiscuous mode（混杂模式），然后这个设备探索网络的所有数据包并存储。</p>
<p>在代码中，我们设定 csmaDevices.Get(1)，第1个csma设备，为混杂promiscuous mode</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">  Simulator::Run ();</div><div class="line">  Simulator::Destroy ();</div><div class="line">  return 0;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>然后运行这个程序</p>
<p>按照<a href="http://fatart.space/ns3%20%E5%91%BD%E4%BB%A4%E8%A1%8C%E5%8F%82%E6%95%B0Command%20Line%20Argument/" target="_blank" rel="external">ns3 命令行参数Command Line Argument</a>上一篇介绍的command line argument system，输入<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ ./waf --run &quot;scratch/mysecond --PrintHelp&quot;</div></pre></td></tr></table></figure></p>
<p>输出</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">second [Program Arguments] [General Arguments]</div><div class="line"></div><div class="line">Program Arguments:</div><div class="line">    --nCsma:    Number of &quot;extra&quot; CSMA nodes/devices [3]</div><div class="line">    --verbose:  Tell echo applications to log if true [true]</div><div class="line"></div><div class="line">General Arguments:</div><div class="line">    --PrintGlobals:              Print the list of globals.</div><div class="line">    --PrintGroups:               Print the list of groups.</div><div class="line">    --PrintGroup=[group]:        Print all TypeIds of group.</div><div class="line">    --PrintTypeIds:              Print all TypeIds.</div><div class="line">    --PrintAttributes=[typeid]:  Print all attributes of typeid.</div><div class="line">    --PrintHelp:                 Print this help message.</div></pre></td></tr></table></figure>
<p>输出了我们在代码中定义并让cmd 系统解析的 program arguments： nCsma和verbose</p>
<p>运行这个程序</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ ./waf --run scratch/mysecond</div></pre></td></tr></table></figure>
<p>结果输出</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">At time 2s client sent 1024 bytes to 10.1.2.4 port 9</div><div class="line">At time 2.0078s server received 1024 bytes from 10.1.1.1 port 49153</div><div class="line">At time 2.0078s server sent 1024 bytes to 10.1.1.1 port 49153</div><div class="line">At time 2.01761s client received 1024 bytes from 10.1.2.4 port 9</div></pre></td></tr></table></figure>
<p>在top-level文件夹下发现3个pcap文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">second-0-0.pcap  second-1-0.pcap  second-2-0.pcap</div></pre></td></tr></table></figure>
<p>格式为<strong><name>-<node>-<device>.pacp</device></node></name></strong></p>
<p>for example : </p>
<ul>
<li>second-0-0.pacp: node zero, device zero, 这是一个节点0上的 point-to-point net device</li>
<li>second-1-0.pcap: node one,  device zero, 这是一盒节点1上的 point-to-point net device</li>
</ul>
<p><strong>node 0 指的是最左边的p2p节点，node1既是p2p，又是csma, node2 是第一个纯csma节点</strong></p>
<p>在代码中，我们设定 csmaDevices.Get(1)，第1个csma设备，为混杂promiscuous mode</p>
<p>下面我们使用tcpdump解析parse trace file</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ tcpdump -nn -tt -r second-0-0.pcap</div><div class="line">$ tcpdump -nn -tt -r second-1-0.pcap</div><div class="line">$ tcpdump -nn -tt -r second-2-0.pcap</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">reading from file second-0-0.pcap, link-type PPP (PPP)    //数据包类型为ppp（point to point类型）</div><div class="line">2.000000 IP 10.1.1.1.49153 &gt; 10.1.2.4.9: UDP, length 1024 //Node 0 p2p netdevice 在 2.0s发送    No.1</div><div class="line">2.017607 IP 10.1.2.4.9 &gt; 10.1.1.1.49153: UDP, length 1024 //client 收到服务器echo               No.9                                   </div><div class="line"></div><div class="line">reading from file second-1-0.pcap, link-type PPP (PPP)</div><div class="line">2.003686 IP 10.1.1.1.49153 &gt; 10.1.2.4.9: UDP, length 1024 </div><div class="line">// Node 1接收到了数据包（2.0s Node 0发送）,并将其传送到CSMA接口，并发送到最终目的节点           No.2 </div><div class="line">2.013921 IP 10.1.2.4.9 &gt; 10.1.1.1.49153: UDP, length 1024//(同时收到了10.1.2.4 echo信息)        No.8</div><div class="line"></div><div class="line">reading from file second-2-0.pcap, link-type EN10MB (Ethernet) //数据类型为 Ethernet</div><div class="line">2.007698 ARP, Request who-has 10.1.2.4 (ff:ff:ff:ff:ff:ff) tell 10.1.2.1, length 50  </div><div class="line">//Node 2 接收到数据包，并发送广播ARP信息请求目标10.1.2.4 MAC地址                                No.3</div><div class="line">2.007710 ARP, Reply 10.1.2.4 is-at 00:00:00:00:00:06, length 50//请求得到MAC地址                No.4                              </div><div class="line">2.007803 IP 10.1.1.1.49153 &gt; 10.1.2.4.9: UDP, length 1024  //转发信息                           No.5</div><div class="line">2.013815 ARP, Request who-has 10.1.2.1 (ff:ff:ff:ff:ff:ff) tell 10.1.2.4, length 50             No.6</div><div class="line">2.013828 ARP, Reply 10.1.2.1 is-at 00:00:00:00:00:03, length 50                                 No.7</div><div class="line">2.013921 IP 10.1.2.4.9 &gt; 10.1.1.1.49153: UDP, length 1024                                       No.8</div></pre></td></tr></table></figure>
<h3 id="同样的可以使用cml-system改变-nCsma-参数"><a href="#同样的可以使用cml-system改变-nCsma-参数" class="headerlink" title="同样的可以使用cml system改变 nCsma 参数"></a>同样的可以使用cml system改变 nCsma 参数</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ ./waf --run &quot;scratch/mysecond --nCsma=4&quot;</div></pre></td></tr></table></figure>
<h3 id="如果你对以一个旁观者角度在CSMA中得到trace-file不满意。你只想从一个单个device中获取trace-file。"><a href="#如果你对以一个旁观者角度在CSMA中得到trace-file不满意。你只想从一个单个device中获取trace-file。" class="headerlink" title="如果你对以一个旁观者角度在CSMA中得到trace file不满意。你只想从一个单个device中获取trace file。"></a>如果你对以一个旁观者角度在CSMA中得到trace file不满意。你只想从一个单个device中获取trace file。</h3><p>Go ahead and replace the EnablePcap calls with the calls below.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">pointToPoint.EnablePcap (&quot;second&quot;, p2pNodes.Get (0)-&gt;GetId (), 0);</div><div class="line">csma.EnablePcap (&quot;second&quot;, csmaNodes.Get (nCsma)-&gt;GetId (), 0, false);</div><div class="line">csma.EnablePcap (&quot;second&quot;, csmaNodes.Get (nCsma-1)-&gt;GetId (), 0, false);</div></pre></td></tr></table></figure>
<h2 id="如何获得node的号码？"><a href="#如何获得node的号码？" class="headerlink" title="如何获得node的号码？"></a>如何获得node的号码？</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">//       10.1.1.0</div><div class="line">// n0 -------------- n1   n2   n3   n4</div><div class="line">//    point-to-point  |    |    |    |</div><div class="line">//                    ================</div><div class="line">//                      LAN 10.1.2.0</div></pre></td></tr></table></figure>
<ol>
<li>节点在创建的时候是从0开始编号的，我们可以人工的记录节点创建的顺序,就如图上所示。</li>
<li>使用Node对象的GetId()函数，它将会返回node ID，This unique id happens to be also the index of the Node into the NodeList.</li>
</ol>
<p>所以我们可以确定 nCsma = 3</p>
<ul>
<li>p2pNodes.Get (0)-&gt;GetId () = 0</li>
<li>csmaNodes.Get (nCsma)-&gt;GetId () = 4;</li>
<li>csmaNodes.Get (nCsma-1)-&gt;GetId () = 3;</li>
</ul>
<h3 id="清除旧的trace-file"><a href="#清除旧的trace-file" class="headerlink" title="清除旧的trace file"></a>清除旧的trace file</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ rm *.pcap</div><div class="line">$ rm *.tr</div></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/ns3 Using the Tracing System/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Fatart's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/ns3 Using the Tracing System/" itemprop="url">ns3 Using the Tracing System</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-08-21T16:28:25+08:00">
                2017-08-21
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/NS3/" itemprop="url" rel="index">
                    <span itemprop="name">NS3</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>详细内容请参考<a href="https://www.nsnam.org/docs/release/3.26/tutorial/html/tweaking.html" target="_blank" rel="external">ns-3 tutorial</a></p>
<h1 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h1><p>我们可以使用以下代码输出，还可以使用logging 模块输出一些信息。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">std::cout &lt;&lt; &quot;The values of x is&quot; &lt;&lt; x &lt;&lt;std::endl;</div></pre></td></tr></table></figure>
<p>但这些方式都有局限性，ns3 tracing system是一个通用（generic）输出。</p>
<p>ns3 tracing system 建立在这样的概念上，独立的tracing source 和 tracing sinks，以及一个统一机制（uniform mechanism）链接 source 和 sinks.</p>
<h2 id="ns-3-tracing-system的基本目标："><a href="#ns-3-tracing-system的基本目标：" class="headerlink" title="ns-3 tracing system的基本目标："></a>ns-3 tracing system的基本目标：</h2><ol>
<li><p>对于基本的任务，tracing system应当允许用户对于那些常用的tracing source                          产生标准的tracing，并能能够设置哪一个对象产生tracing文件</p>
</li>
<li><p>中级的使用者（intermediate user）必须能够拓展tracing系统以修改输出的格式，或者在不修改ns-3 core的情况下,插入新的tracing source，</p>
</li>
<li>高级的用户（advanced user）能够修改仿真器来添加新的tracing source和 sink.</li>
</ol>
<h2 id="什么是ns-3-的-tracing-sources-and-sinks？"><a href="#什么是ns-3-的-tracing-sources-and-sinks？" class="headerlink" title="什么是ns-3 的 tracing sources and sinks？"></a>什么是ns-3 的 tracing sources and sinks？</h2><h3 id="Trace-source"><a href="#Trace-source" class="headerlink" title="Trace source"></a>Trace source</h3><p>Trace source are entities that can signal events that happen in a simulation and provide access to interesting underlying data.<br>跟踪源是可以指示在模拟中发生的事件并提供对感兴趣的底层数据的访问的实体.</p>
<p>比如，一个trace source能够指示一个数据包什么时候被一个网络设备接收，并能为感兴趣的trace sink访问数据包的内容</p>
<p>trace souce 本身是没有作用的，它们必须”连接到”其他的有sink提供信息并实际有用的代码</p>
<h3 id="Trace-sink"><a href="#Trace-sink" class="headerlink" title="Trace sink"></a>Trace sink</h3><p>trace sink是 事件 和 trace source提供的数据的“消费者”。</p>
<p>在本文中，我们将浏览一些预先定义好的source和sink，并且说明它们如何用很少的改动来配置。</p>
<p>高级的tracing配置，包括拓展tracing命名空间和创建新的trace source间 ns3-manual 手册 和 how-to 章节。</p>
<h1 id="ASCII-Tracing"><a href="#ASCII-Tracing" class="headerlink" title="ASCII Tracing"></a>ASCII Tracing</h1><p>我们可以在Simulator::Run()前增加以下代码以添加ASCII tracing</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">AsciiTraceHelper ascii;</div><div class="line">pointToPoint.EnableAsciiAll (ascii.CreateFileStream (&quot;myfirst.tr&quot;));</div></pre></td></tr></table></figure>
<p>then build and run the script</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ ./waf --run scratch/myfirst</div></pre></td></tr></table></figure>
<p>运行结束后，将在top-level 文件夹（ns3.26）创建一个<em>myfirst.tr</em>文件，并输出内容。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">At time 2s client sent 1024 bytes to 10.1.1.2 port 9</div><div class="line">At time 2.00369s server received 1024 bytes from 10.1.1.1 port 49153</div><div class="line">At time 2.00369s server sent 1024 bytes to 10.1.1.1 port 49153</div><div class="line">At time 2.00737s client received 1024 bytes from 10.1.1.2 port 9</div></pre></td></tr></table></figure>
<h2 id="解析（parse）-ASCII-Trace"><a href="#解析（parse）-ASCII-Trace" class="headerlink" title="解析（parse） ASCII Trace"></a>解析（parse） ASCII Trace</h2><p>文件里的每一行都与一个<em>trace event</em>相关。在这个例子里，我们追踪事件是每一个point-to-point netdevice中的<em>transmit queue</em></p>
<p>行首的符号意义如下：</p>
<ul>
<li>+：An enqueue operation occurred on the device queue</li>
<li>-: A dequeue operation occurred on the device queue</li>
<li>d: A packet was dropped, typically because the queue was full</li>
<li>r: A packet was received by the net device</li>
</ul>
<h2 id="完整ASCII-trace文件如下"><a href="#完整ASCII-trace文件如下" class="headerlink" title="完整ASCII trace文件如下"></a>完整ASCII trace文件如下</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">+ </div><div class="line">2</div><div class="line">/NodeList/0/DeviceList/0/$ns3::PointToPointNetDevice/TxQueue/Enqueue </div><div class="line">ns3::PppHeader (Point-to-Point Protocol:IP (0x0021)) </div><div class="line">ns3::Ipv4Header (tos 0x0 DSCP Default ECN Not-ECT ttl 64 id 0 protocol 17 offset (bytes) 0 flags [none] </div><div class="line">length: 1052 10.1.1.1 &gt; 10.1.1.2) </div><div class="line">ns3::UdpHeader (length: 1032 49153 &gt; 9) </div><div class="line">Payload (size=1024)</div></pre></td></tr></table></figure>
<ol>
<li>+号表示这是一个入队操作，第二行的2表示仿真时刻是2s</li>
<li><em>UdpEchoApplication</em>从第2s开始发送数据包。</li>
<li>指出是那一个trace source发起（originate）这个事件（以tracing namespace格式表示），namespace root是<em>NodeList</em>，<em>NodeList/0</em>表示NodeList的第0个，在每一个node下都有DeviceList,可以看出事件是由<em>DeviceList/0</em>发起的</li>
<li><em>$ns3::PointToPointNetDevice</em>告诉我们node 0 的 devcie 0 是一个什么类型的设备。 trace path 是<em>TxQueue/Enqueue</em></li>
<li>数据包以P2P协议压缩，并有IPv4 Header，从10.1.1.1发起，发送到10.1.1.2，数据包有UDP Header，payload是1024bytes</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">-</div><div class="line">2</div><div class="line">/NodeList/0/DeviceList/0/$ns3::PointToPointNetDevice/TxQueue/Dequeue</div><div class="line">ns3::PppHeader (Point-to-Point Protocol: IP (0x0021)) </div><div class="line">ns3::Ipv4Header (tos 0x0 DSCP Default ECN Not-ECT ttl 64 id 0 protocol 17 offset (bytes) 0 flags [none]</div><div class="line">length: 1052 10.1.1.1 &gt; 10.1.1.2) </div><div class="line">ns3::UdpHeader (length: 1032 49153 &gt; 9) </div><div class="line">Payload (size=1024)</div></pre></td></tr></table></figure>
<p>这里和section 1 不同之处在于dequeue，其他都一样，表示在第2秒，Node0-NetDevice0 transmit 1 packet</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">r </div><div class="line">2.00369</div><div class="line">/NodeList/1/DeviceList/0/$ns3::PointToPointNetDevice/MacRx </div><div class="line">ns3::PppHeader (Point-to-Point Protocol: IP (0x0021)) </div><div class="line">ns3::Ipv4Header (tos 0x0 DSCP Default ECN Not-ECT ttl 64 id 0 protocol 17 offset (bytes) 0 flags [none] </div><div class="line">length: 1052 10.1.1.1 &gt; 10.1.1.2) </div><div class="line">ns3::UdpHeader (length: 1032 49153 &gt; 9) </div><div class="line">Payload (size=1024)</div></pre></td></tr></table></figure>
<ol>
<li>r号表示这是收到数据包操作，第二行的2.00369表示仿真时刻是2.00369s</li>
<li><em>UdpEchoServerApplication</em>从第2.00369s开始收到数据包。</li>
<li>由NodeList 1 - Device 0 发起，可见是 server 的 netdevice 发起（originate）的</li>
<li><em>$ns3::PointToPointNetDevice</em>告诉我们node 1 的 devcie 0 是一个什么类型的设备。 packet reception trace source 是<em>MacRx</em></li>
<li>数据包以P2P协议压缩，并有IPv4 Header，从10.1.1.1发起，发送到10.1.1.2，数据包有UDP Header，payload是1024bytes</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">+ </div><div class="line">2.00369 </div><div class="line">/NodeList/1/DeviceList/0/$ns3::PointToPointNetDevice/TxQueue/Enqueue </div><div class="line">ns3::PppHeader (Point-to-Point Protocol: IP (0x0021)) </div><div class="line">ns3::Ipv4Header (tos 0x0 DSCP Default ECN Not-ECT ttl 64 id 0 protocol 17 offset (bytes) 0 flags [none] </div><div class="line">length: 1052 10.1.1.2 &gt; 10.1.1.1) </div><div class="line">ns3::UdpHeader (length: 1032 9 &gt; 49153) </div><div class="line">Payload (size=1024)</div></pre></td></tr></table></figure>
<p>N1 - D0（Server NetDevice）将接收到的数据包enqueue</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">- </div><div class="line">2.00369 </div><div class="line">/NodeList/1/DeviceList/0/$ns3::PointToPointNetDevice/TxQueue/Dequeue </div><div class="line">ns3::PppHeader (Point-to-Point Protocol: IP (0x0021)) </div><div class="line">ns3::Ipv4Header (tos 0x0 DSCP Default ECN Not-ECT ttl 64 id 0 protocol 17 offset (bytes) 0 flags [none] </div><div class="line">length: 1052 10.1.1.2 &gt; 10.1.1.1) </div><div class="line">ns3::UdpHeader (length: 1032 9 &gt; 49153) </div><div class="line">Payload (size=1024)</div></pre></td></tr></table></figure>
<p>N1 - D0（Server NetDevice）echo 一个数据包（10.1.1.2 -&gt; 10.1.1.1）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">r </div><div class="line">2.00737 </div><div class="line">/NodeList/0/DeviceList/0/$ns3::PointToPointNetDevice/MacRx </div><div class="line">ns3::PppHeader (Point-to-Point Protocol: IP (0x0021)) </div><div class="line">ns3::Ipv4Header (tos 0x0 DSCP Default ECN Not-ECT ttl 64 id 0 protocol 17 offset (bytes) 0 flags [none] </div><div class="line">length: 1052 10.1.1.2 &gt; 10.1.1.1) ns3::UdpHeader (length: 1032 9 &gt; 49153) </div><div class="line">Payload (size=1024)</div></pre></td></tr></table></figure>
<p>client 收到了 server 的 echo packet</p>
<p>通过ASCII trace 文件和console 控制台输出结果对照，能够非常方便地了解这个过程。</p>
<h1 id="PCAP-Tracing"><a href="#PCAP-Tracing" class="headerlink" title="PCAP Tracing"></a>PCAP Tracing</h1><p>产生可由Wireshark打开的.pcap追踪文件</p>
<p>同样的，我们添加代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pointToPoint.EnablePcapAll (&quot;myfirst&quot;);</div></pre></td></tr></table></figure>
<p>在ns3的文件夹下出现  myfirst-0-0.pacp（node 0-device 0）和myfirst-1-0.pacp（node 1-device 0）</p>
<h2 id="使用tcpdump-读取-pacap输出"><a href="#使用tcpdump-读取-pacap输出" class="headerlink" title="使用tcpdump 读取 pacap输出"></a>使用tcpdump 读取 pacap输出</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">$ tcpdump -nn -tt -r myfirst-0-0.pcap</div><div class="line">reading from file myfirst-0-0.pcap, link-type PPP (PPP)</div><div class="line">2.000000 IP 10.1.1.1.49153 &gt; 10.1.1.2.9: UDP, length 1024      No.1</div><div class="line">2.007372 IP 10.1.1.2.9 &gt; 10.1.1.1.49153: UDP, length 1024      No.4</div><div class="line"></div><div class="line">tcpdump -nn -tt -r myfirst-1-0.pcap</div><div class="line">reading from file myfirst-1-0.pcap, link-type PPP (PPP)</div><div class="line">2.003686 IP 10.1.1.1.49153 &gt; 10.1.1.2.9: UDP, length 1024      No.2</div><div class="line">2.003686 IP 10.1.1.2.9 &gt; 10.1.1.1.49153: UDP, length 1024      No.3</div></pre></td></tr></table></figure>
<p>从两个文件的时间顺序分析得到，流程顺序如 No.1-4</p>
<h2 id="Reading-output-with-Wireshark"><a href="#Reading-output-with-Wireshark" class="headerlink" title="Reading output with Wireshark"></a>Reading output with Wireshark</h2><p>可以下载wireshark 软件打开文件</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.gif"
               alt="" />
          <p class="site-author-name" itemprop="name"></p>
           
              <p class="site-description motion-element" itemprop="description">�������ɣ�������̫��</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives/">
                <span class="site-state-item-count">22</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">5</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">10</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder"></span>

  
</div>


  <div class="powered-by">
    由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
  </div>

  <span class="post-meta-divider">|</span>

  <div class="theme-info">
    主题 &mdash;
    <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
      NexT.Mist
    </a>
  </div>


        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.2"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.2"></script>



  
  

  
    <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.2"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.2"></script>

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.2"></script>



  


  




	





  





  








  





  

  

  

  

  

  

</body>
</html>
